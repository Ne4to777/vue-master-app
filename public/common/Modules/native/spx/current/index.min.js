var spx=function(e,t){"use strict";function r(e,t,r,n,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,i)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){var a=e.apply(t,n);function u(e){r(a,i,o,u,s,"next",e)}function s(e){r(a,i,o,u,s,"throw",e)}u(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,r){return(p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&h(i,r.prototype),i}).apply(null,arguments)}function m(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function g(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t){return y(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}(e,t)||w()}function v(e){return y(e)||x(e)||w()}function b(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e){if(Array.isArray(e))return e}function x(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function k(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}t=t&&t.hasOwnProperty("default")?t.default:t;var _,R,S,U,P=(function(e,t){var r,n,i,o=void 0,a=1e5,u=(r=Object.prototype.toString,n=Object.prototype.hasOwnProperty,{Class:function(e){return r.call(e).replace(/^\[object *|\]$/g,"")},HasProperty:function(e,t){return t in e},HasOwnProperty:function(e,t){return n.call(e,t)},IsCallable:function(e){return"function"==typeof e},ToInt32:function(e){return e>>0},ToUint32:function(e){return e>>>0}}),s=Math.LN2,c=Math.abs,l=Math.floor,f=Math.log,h=Math.min,p=Math.pow,m=Math.round;function g(e){if(d&&i){var t,r=d(e);for(t=0;t<r.length;t+=1)i(e,r[t],{value:e[r[t]],writable:!1,enumerable:!1,configurable:!1})}}i=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()?Object.defineProperty:function(e,t,r){if(!e===Object(e))throw new TypeError("Object.defineProperty called on non-object");return u.HasProperty(r,"get")&&Object.prototype.__defineGetter__&&Object.prototype.__defineGetter__.call(e,t,r.get),u.HasProperty(r,"set")&&Object.prototype.__defineSetter__&&Object.prototype.__defineSetter__.call(e,t,r.set),u.HasProperty(r,"value")&&(e[t]=r.value),e};var d=Object.getOwnPropertyNames||function(e){if(e!==Object(e))throw new TypeError("Object.getOwnPropertyNames called on non-object");var t,r=[];for(t in e)u.HasOwnProperty(e,t)&&r.push(t);return r};function v(e){if(i){if(e.length>a)throw new RangeError("Array too large for polyfill");var t;for(t=0;t<e.length;t+=1)r(t)}function r(t){i(e,t,{get:function(){return e._getter(t)},set:function(r){e._setter(t,r)},enumerable:!0,configurable:!1})}}function b(e,t){var r=32-t;return e<<r>>r}function y(e,t){var r=32-t;return e<<r>>>r}function x(e){return[255&e]}function w(e){return b(e[0],8)}function k(e){return[255&e]}function _(e){return y(e[0],8)}function R(e){return[(e=m(Number(e)))<0?0:e>255?255:255&e]}function S(e){return[e>>8&255,255&e]}function U(e){return b(e[0]<<8|e[1],16)}function P(e){return[e>>8&255,255&e]}function T(e){return y(e[0]<<8|e[1],16)}function C(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}function O(e){return b(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function E(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}function I(e){return y(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function j(e,t,r){var n,i,o,a,u,m,g,d=(1<<t-1)-1;function v(e){var t=l(e),r=e-t;return r<.5?t:r>.5?t+1:t%2?t+1:t}for(e!=e?(i=(1<<t)-1,o=p(2,r-1),n=0):e===1/0||e===-1/0?(i=(1<<t)-1,o=0,n=e<0?1:0):0===e?(i=0,o=0,n=1/e==-1/0?1:0):(n=e<0,(e=c(e))>=p(2,1-d)?(i=h(l(f(e)/s),1023),(o=v(e/p(2,i)*p(2,r)))/p(2,r)>=2&&(i+=1,o=1),i>d?(i=(1<<t)-1,o=0):(i+=d,o-=p(2,r))):(i=0,o=v(e/p(2,1-d-r)))),u=[],a=r;a;a-=1)u.push(o%2?1:0),o=l(o/2);for(a=t;a;a-=1)u.push(i%2?1:0),i=l(i/2);for(u.push(n?1:0),u.reverse(),m=u.join(""),g=[];m.length;)g.push(parseInt(m.substring(0,8),2)),m=m.substring(8);return g}function L(e,t,r){var n,i,o,a,u,s,c,l,f=[];for(n=e.length;n;n-=1)for(o=e[n-1],i=8;i;i-=1)f.push(o%2?1:0),o>>=1;return f.reverse(),a=f.join(""),u=(1<<t-1)-1,s=parseInt(a.substring(0,1),2)?-1:1,c=parseInt(a.substring(1,1+t),2),l=parseInt(a.substring(1+t),2),c===(1<<t)-1?0!==l?NaN:s*(1/0):c>0?s*p(2,c-u)*(1+l/p(2,r)):0!==l?s*p(2,-(u-1))*(l/p(2,r)):s<0?-0:0}function A(e){return L(e,11,52)}function F(e){return j(e,11,52)}function M(e){return L(e,8,23)}function B(e){return j(e,8,23)}!function(){var e=function(e){if((e=u.ToInt32(e))<0)throw new RangeError("ArrayBuffer size is not a small enough positive integer");var t;for(this.byteLength=e,this._bytes=[],this._bytes.length=e,t=0;t<this.byteLength;t+=1)this._bytes[t]=0;g(this)};t.ArrayBuffer=t.ArrayBuffer||e;var r=function(){};function n(t,n,i){var a;return(a=function(t,r,n){var i,o,s,c;if(arguments.length&&"number"!=typeof arguments[0])if("object"==typeof arguments[0]&&arguments[0].constructor===a)for(i=arguments[0],this.length=i.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),this.byteOffset=0,s=0;s<this.length;s+=1)this._setter(s,i._getter(s));else if("object"!=typeof arguments[0]||arguments[0]instanceof e||"ArrayBuffer"===u.Class(arguments[0])){if("object"!=typeof arguments[0]||!(arguments[0]instanceof e||"ArrayBuffer"===u.Class(arguments[0])))throw new TypeError("Unexpected argument type(s)");if(this.buffer=t,this.byteOffset=u.ToUint32(r),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");if(arguments.length<3){if(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT)throw new RangeError("length of buffer minus byteOffset not a multiple of the element size");this.length=this.byteLength/this.BYTES_PER_ELEMENT}else this.length=u.ToUint32(n),this.byteLength=this.length*this.BYTES_PER_ELEMENT;if(this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer")}else for(o=arguments[0],this.length=u.ToUint32(o.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),this.byteOffset=0,s=0;s<this.length;s+=1)c=o[s],this._setter(s,Number(c));else{if(this.length=u.ToInt32(arguments[0]),n<0)throw new RangeError("ArrayBufferView size is not a small enough positive integer");this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new e(this.byteLength),this.byteOffset=0}this.constructor=a,g(this),v(this)}).prototype=new r,a.prototype.BYTES_PER_ELEMENT=t,a.prototype._pack=n,a.prototype._unpack=i,a.BYTES_PER_ELEMENT=t,a.prototype._getter=function(e){if(arguments.length<1)throw new SyntaxError("Not enough arguments");if((e=u.ToUint32(e))>=this.length)return o;var t,r,n=[];for(t=0,r=this.byteOffset+e*this.BYTES_PER_ELEMENT;t<this.BYTES_PER_ELEMENT;t+=1,r+=1)n.push(this.buffer._bytes[r]);return this._unpack(n)},a.prototype.get=a.prototype._getter,a.prototype._setter=function(e,t){if(arguments.length<2)throw new SyntaxError("Not enough arguments");if((e=u.ToUint32(e))>=this.length)return o;var r,n,i=this._pack(t);for(r=0,n=this.byteOffset+e*this.BYTES_PER_ELEMENT;r<this.BYTES_PER_ELEMENT;r+=1,n+=1)this.buffer._bytes[n]=i[r]},a.prototype.set=function(e,t){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var r,n,i,o,a,s,c,l,f,h;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(r=arguments[0],(i=u.ToUint32(arguments[1]))+r.length>this.length)throw new RangeError("Offset plus length of array is out of range");if(l=this.byteOffset+i*this.BYTES_PER_ELEMENT,f=r.length*this.BYTES_PER_ELEMENT,r.buffer===this.buffer){for(h=[],a=0,s=r.byteOffset;a<f;a+=1,s+=1)h[a]=r.buffer._bytes[s];for(a=0,c=l;a<f;a+=1,c+=1)this.buffer._bytes[c]=h[a]}else for(a=0,s=r.byteOffset,c=l;a<f;a+=1,s+=1,c+=1)this.buffer._bytes[c]=r.buffer._bytes[s]}else{if("object"!=typeof arguments[0]||void 0===arguments[0].length)throw new TypeError("Unexpected argument type(s)");if(n=arguments[0],o=u.ToUint32(n.length),(i=u.ToUint32(arguments[1]))+o>this.length)throw new RangeError("Offset plus length of array is out of range");for(a=0;a<o;a+=1)s=n[a],this._setter(i+a,Number(s))}},a.prototype.subarray=function(e,t){function r(e,t,r){return e<t?t:e>r?r:e}e=u.ToInt32(e),t=u.ToInt32(t),arguments.length<1&&(e=0),arguments.length<2&&(t=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e=r(e,0,this.length);var n=(t=r(t,0,this.length))-e;return n<0&&(n=0),new this.constructor(this.buffer,this.byteOffset+e*this.BYTES_PER_ELEMENT,n)},a}var i=n(1,x,w),a=n(1,k,_),s=n(1,R,_),c=n(2,S,U),l=n(2,P,T),f=n(4,C,O),h=n(4,E,I),p=n(4,B,M),m=n(8,F,A);t.Int8Array=t.Int8Array||i,t.Uint8Array=t.Uint8Array||a,t.Uint8ClampedArray=t.Uint8ClampedArray||s,t.Int16Array=t.Int16Array||c,t.Uint16Array=t.Uint16Array||l,t.Int32Array=t.Int32Array||f,t.Uint32Array=t.Uint32Array||h,t.Float32Array=t.Float32Array||p,t.Float64Array=t.Float64Array||m}(),function(){function e(e,t){return u.IsCallable(e.get)?e.get(t):e[t]}var r,n=(r=new t.Uint16Array([4660]),18===e(new t.Uint8Array(r.buffer),0)),i=function(e,r,n){if(0===arguments.length)e=new t.ArrayBuffer(0);else if(!(e instanceof t.ArrayBuffer||"ArrayBuffer"===u.Class(e)))throw new TypeError("TypeError");if(this.buffer=e||new t.ArrayBuffer(0),this.byteOffset=u.ToUint32(r),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(arguments.length<3?this.byteLength=this.buffer.byteLength-this.byteOffset:this.byteLength=u.ToUint32(n),this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer");g(this)};function o(r){return function(i,o){if((i=u.ToUint32(i))+r.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");i+=this.byteOffset;var a,s=new t.Uint8Array(this.buffer,i,r.BYTES_PER_ELEMENT),c=[];for(a=0;a<r.BYTES_PER_ELEMENT;a+=1)c.push(e(s,a));return Boolean(o)===Boolean(n)&&c.reverse(),e(new r(new t.Uint8Array(c).buffer),0)}}function a(r){return function(i,o,a){if((i=u.ToUint32(i))+r.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");var s,c=new r([o]),l=new t.Uint8Array(c.buffer),f=[];for(s=0;s<r.BYTES_PER_ELEMENT;s+=1)f.push(e(l,s));Boolean(a)===Boolean(n)&&f.reverse(),new t.Uint8Array(this.buffer,i,r.BYTES_PER_ELEMENT).set(f)}}i.prototype.getUint8=o(t.Uint8Array),i.prototype.getInt8=o(t.Int8Array),i.prototype.getUint16=o(t.Uint16Array),i.prototype.getInt16=o(t.Int16Array),i.prototype.getUint32=o(t.Uint32Array),i.prototype.getInt32=o(t.Int32Array),i.prototype.getFloat32=o(t.Float32Array),i.prototype.getFloat64=o(t.Float64Array),i.prototype.setUint8=a(t.Uint8Array),i.prototype.setInt8=a(t.Int8Array),i.prototype.setUint16=a(t.Uint16Array),i.prototype.setInt16=a(t.Int16Array),i.prototype.setUint32=a(t.Uint32Array),i.prototype.setInt32=a(t.Int32Array),i.prototype.setFloat32=a(t.Float32Array),i.prototype.setFloat64=a(t.Float64Array),t.DataView=t.DataView||i}()}(_={exports:{}},_.exports),_.exports),T=(P.ArrayBuffer,P.Int8Array,P.Uint8Array),C=(P.Uint8ClampedArray,P.Int16Array,P.Uint16Array,P.Int32Array,P.Uint32Array,P.Float32Array,P.Float64Array,P.DataView,void 0),O={create:"created",update:"updated",delete:"deleted",recycle:"recycled",get:"get",copy:"copied",move:"moved",restore:"restored",clear:"cleared",erase:"erased",send:"sent"},E={101:!0,109:!0,110:!0,113:!0,114:!0,116:!0,119:!0,121:!0,122:!0,123:!0,175:!0,851:!0,10102:!0},I={AppAuthor:!0,AppEditor:!0,Author:!0,CheckedOutTitle:!0,CheckedOutUserId:!0,CheckoutUser:!0,ContentTypeId:!0,Created:!0,Created_x0020_By:!0,Created_x0020_Date:!0,DocConcurrencyNumber:!0,Editor:!0,FSObjType:!0,FileDirRef:!0,FileLeafRef:!0,FileRef:!0,File_x0020_Size:!0,File_x0020_Type:!0,FolderChildCount:!0,GUID:!0,HTML_x0020_File_x0020_Type:!0,ID:!0,InstanceID:!0,IsCheckedoutToLocal:!0,ItemChildCount:!0,Last_x0020_Modified:!0,MetaInfo:!0,Modified:!0,Modified_x0020_By:!0,Order:!0,ParentLeafName:!0,ParentVersionString:!0,ProgId:!0,ScopeId:!0,SortBehavior:!0,SyncClientId:!0,TemplateUrl:!0,UniqueId:!0,VirusStatus:!0,WorkflowInstanceID:!0,WorkflowVersion:!0,owshiddenversion:!0,xd_ProgID:!0,xd_Signature:!0,_CheckinComment:!0,_CopySource:!0,_HasCopyDestinations:!0,_IsCurrentVersion:!0,_Level:!0,_ModerationComments:!0,_ModerationStatus:!0,_SharedFileIndex:!0,_SourceUrl:!0,_UIVersion:!0,_UIVersionString:!0,ImageHeight:!0,ImageWidth:!0,PreviewExists:!0,ThumbnailExists:!0},j=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},L={I:function(e){return e},K:function(e){return function(){return e}},A:function(e){return function(t){return e(t)}},U:function(e){return e(e)},Y:function(e){return L.U(function(t){return e(function(e){return t(t)(e)})})},C:function(e){return function(t){return function(r){return e(r)(t)}}},S:function(e){return function(t){return function(r){return e(r)(t(r))}}},SI:function(e){return function(t){return function(r){return t(r)(e(r))}}},SA:function(e){return function(t){return function(){var r=n(regeneratorRuntime.mark(function r(n){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e(n),r.next=3,t(n);case 3:return r.t1=r.sent,r.abrupt("return",(0,r.t0)(r.t1));case 5:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}},SIA:function(e){return function(t){return function(){var r=n(regeneratorRuntime.mark(function r(n){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=t(n),r.next=3,e(n);case 3:return r.t1=r.sent,r.abrupt("return",(0,r.t0)(r.t1));case 5:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}}},A=L.I,F=L.K,M=L.Y,B=L.C,N=function(e){return function(t){return e(t),t}},D=function(e){return function(t,r){return e(t)(r)}},V=function(e){return function(t){var r=d(t,2),n=r[0],i=r[1];return function(t){return e(t)?n(t):i?i(t):t}}},Q=function(e){return function(t){return function(r){var n=t[e(r)];return n?n(r):t.default?t.default(r):void 0}}},H=Q(j),q=function(e){return function(t){return e+t}},W=function(e){return function(t){return e<t}},G=function(e){return function(t){return e.test(t)}},$=function(e){return function(t){return function(r){return r.replace(e,t)}}},K=function(e){return function(t){return t.match(e)||[]}},Y=function(e){return $(e)("")},J=function(e){return function(t){return t.split(e)}},z=function(e){return e.trim()},X=function(e){return"array"===j(e)?e:e?[e]:[]},Z=function(e){return function(t){return t.map(e)}},ee=function(e){return function(t){return t.filter(e)}},te=function(e){return function(t){return t.join(e)}},re=ee(function(e){return void 0!==e}),ne=function(e){return function(t){return e.concat(t)}},ie=function(e){return function(t){return function(r){return r.reduce(D(e),H({object:F({}),array:F([]),default:A})(t))}}},oe=ie(function(e){return Re([V(Oe)([oe,A]),ne(e)])})([]),ae=function(e){return e[0]},ue=function(e){return v(e).slice(1)},se=function(e){return e[e.length-1]},ce=(R=0,S=-1,function(e){return e.slice(R,S)}),le=function(){return[]},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return function(r){var n=e;return ie(function(e){return function(r){void 0===e[n]&&(e[n]=[]);var i=e[n];return i.push(r),i.length===t&&(n+=1),e}})([])(r)}}}(),he=function(e){return ee(function(t){return!!t[e]})},pe=function(e){return Re([ie(function(t){return function(r){return t[r[e]]=r,t}})({}),Object.values])},me=function(e){return function(t){return t[e]?t[e]():t}},ge=function(e){return function(t){return function(r){return r[e]?r[e](t):r}}},de=function(e){return function(t){return function(r){return t[e]?t[e](r):t}}},ve=function(e){return function(t){return function(r){return t[e].apply(t,b(r))}}},be=function(e){return function(t){return t[e]}},ye=function(e){return Object.keys(e)},xe=function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return p(e,r)}},we=function(e){return new e},ke=function(){return null},_e=function(e){return M(function(t){return function(r){var n=v(r),i=n[0],o=n.slice(1);return function(r){return o.length?t(o)(e(i)(r)):e(i)(r)}}})},Re=ie(function(e){return function(t){return function(r){return t(e(r))}}})(A),Se=function(e){return!!e},Ue=function(e){return!e},Pe=function(){return!1},Te=(Re([function(e){return function(t){return t===e}},Ue]),function(e){return"number"===j(e)}),Ce=function(e){return"string"===j(e)},Oe=function(e){return"array"===j(e)},Ee=function(e){return"object"===j(e)},Ie=function(e){var t=j(e);return"blob"===t||"file"===t},je=G(/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/),Le=function(e){return null===e},Ae=Re([Le,Ue]),Fe=function(e){return void 0===e},Me=Re([Fe,Ue]),Be=Re([function(e){return 0===e},Ue]),Ne=Re([function(e){return"number"===j(e)&&"NaN"===e.toString()},Ue]),De=function(e){return Te(e)&&Be(e)&&Ne(e)},Ve=function(e){return""===e},Qe=Re([Ve,Ue]),He=Re([ee(Me),be("length"),Se]),qe=Re([He,Ue]),We=V(Ee)([Re([ye,He]),Pe]),Ge=(Re([ye,qe]),function(e){return"error"!==j(e)}),$e=function(e){return Me(e)&&Ae(e)},Ke=(Re([$e,Ue]),V($e)([H({number:De,string:Qe,array:He,object:We,null:Pe,default:function(){return!0}}),Se])),Ye=(Re([Ke,Ue]),function(e){return function(t){return t[e]}}),Je=function(e){return Re([be(e),$e])},ze=function(e){return Re([be(e),Ke])},Xe=function(e){return function(t){return function(r){try{return e(r)}catch(e){return t(e)(r)}}}},Ze=function(e){throw new Error(e)},et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.silent||t.silentInfo||console.log(e)},tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.box,n=t.name,i=t.detailed,o=r.getCount();et("".concat(O[e]," ").concat(o," ").concat(n).concat(o>1?"s":"").concat(i?": ".concat(r.join()):""," "),t)},rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.box,n=t.name,i=t.detailed,o=t.contextUrl,a=r.getCount(e);et("".concat(O[e]," ").concat(a," ").concat(n).concat(a>1?"s":""," at ").concat(o||"/").concat(i?": ".concat(r.join()):""),t)},nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.box,n=t.name,i=t.detailed,o=t.contextUrl,a=t.listUrl,u=r.getCount(e);et("".concat(O[e]," ").concat(u," ").concat(n).concat(u>1?"s":""," in ").concat(a," at ").concat(o||"/").concat(i?": ".concat(r.join()):""),t)},it=B(function(e){return function(t){return function(r){return X(r).reduce(D(B(e)),X(t))}}}(Re([function(e){return ie(function(t){return function(r){var n=r[e],i=$e(n)&&n.get_lookupId?n.get_lookupId():n,o=t[i];return t[i]=Fe(o)?[r]:Oe(o)?ne(o)(r):[o,r],t}})({})},function(e){return M(function(t){return function(r){return H({array:e,object:function(n){for(var i=Reflect.ownKeys(n),o=0;o<i.length;o+=1){var a=i[o],u=n[a];r[a]=Oe(u)?e(u):t({})(u)}return r},default:A})}})({})}]))),ot=function(e){return function(t){return ie(function(t){return function(r){var n=r[e];return t[$e(n)&&n.get_lookupId?n.get_lookupId():n]=r,t}})({})(X(t))}},at=G(/\/$/),ut=G(/\.[^\/]+$/),st=he("Url"),ct=(ee(Re([be("ID"),De])),ee(function(e){return e.Url&&ut(e.Url)})),lt=pe("Url"),ft=V(G(/^\//))([A,q("/")]),ht=Y(/\/$/),pt=Y(/^\//),mt=$(/\/\/+/g)("/"),gt=J("/"),dt=Re([ht,gt,se]),vt=te("/"),bt=Re([ht,gt,ce,vt]),yt=V(G(/\./))([bt,ht]),xt=V(G(/\./))([dt,ke]),wt=function(e){return Qe(e)&&!at(e)},kt=function(e){return function(t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.Url,i=r.Folder;if(i){var o=pt(i);return n?"".concat(o,"/").concat(dt(n)):o}return n&&G(/\//)(n)?"/"===n?"/":pt(se(J("@list@")($(t)("@list@")($(pt(e))("@web@")(n))))):n}}},_t=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.Url,n=t.Folder;if(n){var i=pt(n);return r?"".concat(i,"/").concat(dt(r)):i}return r&&G(/\//)(r)?"/"===r?"/":pt(se(J("@web@")($(pt(e))("@web@")(r)))):r}},Rt=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;i(this,e),this.prop="Url",this.joinProp="Url",this.value=Oe(t)?V(He)([Re([Z(r),n]),F([r()])])(t):r(t)}return a(e,[{key:"reduce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Oe(this.value)?ie(e)(t)(this.value):e(t)(this.value)}},{key:"some",value:function(e){return Oe(this.value)?this.value.some(e):e(this.value)}},{key:"chain",value:function(e){return Oe(this.value)?Promise.all(Z(e)(this.value)):e(this.value)}},{key:"join",value:function(){return Oe(this.value)?te(", ")(Z(be(this.joinProp))(this.value)):this.value[this.joinProp]}},{key:"getCount",value:function(){var e=this;return Oe(this.value)?this.value.filter(function(t){return Me(t[e.prop])}).length:Me(this.value[this.prop])?1:0}},{key:"getHead",value:function(){return Oe(this.value)?this.value[0]:this.value}},{key:"getHeadPropValue",value:function(){return Oe(this.value)?this.value[0]?this.value[0][this.prop]:void 0:this.value[this.prop]}},{key:"getIterable",value:function(){return Oe(this.value)?this.value:[this.value]}},{key:"isArray",value:function(){return Oe(this.value)}}]),e}(),St=function(e){var t=e.contextUrl,r=void 0===t?"/":t,i=e.elementBox,o=e.bundleSize,a=void 0===o?252:o;return function(){var e=n(regeneratorRuntime.mark(function e(t){var n,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,o=Tt(r),u=[o],e.next=5,i.chain(function(e){return(n+=1)>=a&&(o=Tt(r),u.push(o),n=0),t({clientContext:o,element:e})});case 5:return s=e.sent,e.abrupt("return",{clientContexts:u,result:s});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ut=function(e){var t=e.elementBox;return function(e){return t.chain(function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e({element:r}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},Pt=xe(SP.ClientContext),Tt=function(e){var t=e;/^https?:/.test(e)||/^\//.test(e)||(t=ft(e)),/\.\/$/.test(t)&&(t=ht(t));var r=Pt(t);return r.set_requestTimeout(36e5),r},Ct=function(e){return V($e)([Re([V(F(e))([me("get_listItemAllFields")]),V(Ee)([(t={get_fieldValues:me("get_fieldValues"),get_objectData:Re([me("get_objectData"),me("get_properties")]),default:Xe(Re([JSON.stringify,q("Wrong spObject: "),Ze]))(Ze)},function(e){for(var r=Reflect.ownKeys(t),n=0;n<r.length;n+=1){var i=r[n];if(e[i])return t[i](e);if(e.default)return e.default(e)}})])])]);var t},Ot=Re([V(Ye("body"))([Re([be("body"),V(Ce)([JSON.parse])]),be("data")]),V(Ye("d"))([Re([be("d"),V(Ye("results"))([be("results")])])])]),Et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return V(Oe)([Re([oe,re,V(F(t.expanded))([A,Re([Z(Ct(t.asItem)),V(F(t.groupBy))([it(t.groupBy),V(F(t.mapBy))([ot(t.mapBy)])])])])]),V(F(t.expanded))([A,Ct(t.asItem)])])(e)},It=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return V(Oe)([Re([oe,Re([V(F(t.expanded))([A]),Z(Ot),V(F(t.groupBy))([it(t.groupBy),V(F(t.mapBy))([ot(t.mapBy)])])])]),Ot])(e)},jt=V(We)([V(ze("view"))([V(ze("groupBy"))([function(e){return ne(X(e.view))(X(e.groupBy))},Re([be("view"),X])]),le]),le]),Lt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return V(Ye("getEnumerator"))([Re([function(e){return Re([F(jt(r)),V(He)([function(t){return[e,"Include(".concat(t,")")]},F([e])])])(e)},ve("loadQuery")(e)]),N(Re([function(e){return Re([F(jt(r)),V(He)([function(t){return[e,t]},F([e])])])(e)},ve("load")(e)]))])(t)},At=function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){t.executeQueryAsync(e,function(e,t){var n=t.get_errorTraceCorrelationId();r(new Error("\nMessage: ".concat(t.get_message().replace(/\n{1,}/g," "),"\nValue: ").concat(t.get_errorValue(),"\nType: ").concat(t.get_errorTypeName(),"\nId: ").concat(n)))})}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Ft=function(){var e=n(regeneratorRuntime.mark(function e(t,r,n){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Lt(t,r,n),e.next=3,At(t);case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}(),Mt=function(){var e=n(regeneratorRuntime.mark(function e(t){var r,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",Re([mt,ht,ft,xe(SP.RequestExecutor),function(e){return new Promise(function(t,n){return e.executeAsync(c({},r,{method:Re([be("method"),V(G(/post/i))([F("POST"),F("GET")])])(r),success:t,error:function(e){var t=r.silent,i=r.silentErrors;if(!t&&!i){var o=e.body;if("string"===j(e.body))try{o=JSON.parse(e.body).error.message.value}catch(e){}console.error("\nMessage: ".concat(e.statusText,"\nCode: ").concat(e.statusCode,"\nValue: ").concat(o))}n(e)}}))})}])(t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Bt={ascii:function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},indices:function(){if(!C.cache){C.cache={};for(var e=Bt.ascii(),t=0;t<e.length;t+=1)C.cache[e[t]]=t}return C.cache}},Nt=window.btoa||function(e){for(var t=Bt.ascii(),r=e.length-1,n=-1,i="";n<r;){var o=e.charCodeAt(++n)<<16|e.charCodeAt(++n)<<8|e.charCodeAt(++n);i+=t[o>>>18&63]+t[o>>>12&63]+t[o>>>6&63]+t[63&o]}var a=e.length%3;if(a>0)for(i=i.slice(0,a-3);i.length%4!=0;)i+="=";return i},Dt=H({arraybuffer:Re([xe(T),ie((U=String.fromCharCode,function(e){return function(t){return e+U(t)}}))(""),Nt]),default:Xe(Nt)(function(){return A})}),Vt=function(e){return function(t){return function(r){return t.set_item(e,r)}}},Qt=function(e){return V(F(e))([_e(function(e){return Re([me("get_folders"),ge("getByUrl")(e)])})(Re([$(/\/\/+/)("/"),J("/")])(e)),A])},Ht=function(e){return function(t){return function(r){for(var n=Reflect.ownKeys(t),i=0;i<n.length;i+=1){var o=n[i],a=e[o],u=t[o];a?function(){var e=Vt(a.InternalName)(r),t=function(t){return function(r){return Re([t(r),e])}};switch(a.TypeAsString){case"Lookup":t(Gt)(SP.FieldLookupValue)(u);break;case"LookupMulti":t(qt)(SP.FieldLookupValue)(X(u));break;case"User":t(Gt)(SP.FieldUserValue)(u);break;case"UserMulti":t(qt)(SP.FieldUserValue)(X(u));break;case"TaxonomyFieldType":e("-1;#".concat(u.get_label(),"|").concat(u.get_termGuid()));break;case"TaxonomyFieldTypeMulti":H({object:Re([be("$2_1"),Re([ie(function(e){return function(t){return e.concat("-1;#".concat(t.get_label(),"|").concat(t.get_termGuid()))}})([]),te(";#"),e])]),array:Re([te(";"),Vt("TaxKeywordTaxHTField")(r)]),string:Vt("TaxKeywordTaxHTField")(r)})(u);break;default:e(u)}}():Vt(o)(r)(u)}return r.update(),r}}},qt=function(e){return Re([ie(function(t){return V($e)([Re([Gt(e),ne(t)])])})([]),V(He)([A,ke])])},Wt=function(e){return function(t){return Re([we,N(ge("set_lookupId")(t))])(e)}},Gt=function(e){return Re([V(Le)([ke,V(Ye("get_lookupId"))([Re([me("get_lookupId"),Wt(e)]),Re([parseInt,V(F((t=Te,function(e){return Se(t&&e)})(W(0))))([Wt(e),ke])])])])]);var t},$t=function(e){return function(t){for(var r=Reflect.ownKeys(e),n=0;n<r.length;n+=1){var i=r[n],o=e[i];void 0!==o&&t[i]&&t[i](o)}return t}},Kt=function(e){return t({url:"".concat(ft(e),"/_api/contextinfo"),headers:{Accept:"application/json; odata=verbose"},method:"POST"}).then(function(e){return e.data.d.GetContextWebInformation.FormDigestValue})},Yt=function e(){return e.cache||(t=SP.PermissionKind,e.cache=Object.keys(t).reduce(function(e,r){var n=t[r];return Te(n)&&(e[r]=n),e},{}));var t},Jt=H({object:function(e){return Object.assign({},e)},string:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return u({},"Query",e)},default:function(){return u({},"Query","")}}),zt=xe(function(){function e(t,r){i(this,e),this.name="search",this.parent=t,this.element=Jt(r),this.contextUrl=t.box.getHeadPropValue(),this.rowsPerPage=this.element.RowsPerPage||10,void 0===this.element.StartRow&&(this.element.StartRow=0)}var t,r,o,u;return a(e,[{key:"get",value:(u=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(this.contextUrl||"/"),n=this.element,i=new Microsoft.SharePoint.Client.Search.Query.SearchExecutor(r),o=new Microsoft.SharePoint.Client.Search.Query.KeywordQuery(r),$t({set_queryText:n.Query,set_clientType:n.ClientType||"AllResultsQuery",set_queryTemplate:n.QueryTemplate?n.QueryTemplate.join(" "):void 0,set_refiners:n.Refiners,set_rowsPerPage:n.RowsPerPage||this.rowsPerPage,set_totalRowsExactMinimum:n.TotalRowsExactMinimum||11,set_blockDedupeMode:n.BlockDedupeMode,set_bypassResultTypes:n.BypassResultTypes,set_collapseSpecification:n.CollapseSpecification,set_culture:n.Culture||1033,set_desiredSnippetLength:n.DesiredSnippetLength,set_enableInterleaving:n.EnableInterleaving,set_enableNicknames:n.EnableNicknames,set_enableOrderHitHighlightedProperty:n.EnableOrderHitHighlightedProperty,set_enablePhonetic:n.EnablePhonetic,set_enableQueryRules:n.EnableQueryRules,set_enableSorting:n.EnableSorting,set_enableStemming:n.EnableStemming,set_generateBlockRankLog:n.GenerateBlockRankLog,set_hiddenConstrains:n.HiddenConstrains,set_hitHighlightedMultivaluePropertyLimit:n.HitHighlightedMultivaluePropertyLimit,set_impressionID:n.ImpressionID,set_maxSnippetLength:n.MaxSnippetLength,set_personalizationData:n.PersonalizationData,set_processBestBets:n.ProcessBestBets,set_processPersonalFavorites:n.ProcessPersonalFavorites,set_queryTag:n.QueryTag,set_rankingModelId:n.RankingModelId,set_refinementFilters:n.RefinementFilters,set_reorderingRules:n.ReorderingRules,set_resultsUrl:n.ResultsUrl,set_rowLimit:n.RowLimit||10,set_startRow:n.StartRow,set_showPeopleNameSuggestions:n.ShowPeopleNameSuggestions||!1,set_summaryLength:n.SummaryLength,set_timeZoneId:n.TimeZoneId,set_timeout:n.Timeout,set_trimDuplicates:n.TrimDuplicates,set_trimDuplicatesIncludeId:n.TrimDuplicatesIncludeId,set_uiLanguage:n.UiLanguage||1033})(o),Lt(r,o,t),a=i.executeQuery(o),e.next=9,At(r);case 9:return e.abrupt("return",a.get_value());case 10:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"next",value:(o=n(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return r=e.sent,this.element.StartRow+=this.rowsPerPage,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"previous",value:(r=n(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return r=e.sent,this.element.StartRow-=this.rowsPerPage,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"move",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=t.page,this.element.StartRow=r*this.rowsPerPage,e.abrupt("return",this.get(t));case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})}]),e}()),Xt="Title",Zt=Re([he(Xt),pe(Xt)]),er=H({object:function(e){var t=Object.assign({},e);return"/"!==e[Xt]&&(t[Xt]=pt(t[Xt])),e[Xt]||(t[Xt]=e.EntityPropertyName||e.InternalName||e.StaticName),e.Type||(t.Type="Text"),t},string:function(e){var t;return u(t={},Xt,"/"===e?"/":pt(mt(e))),u(t,"Type","Text"),t},default:function(){var e;return u(e={},Xt,void 0),u(e,"Type","Text"),e}}),tr=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i(this,t),(e=g(this,f(t).call(this,r,er,Zt))).prop=Xt,e.joinProp=Xt,e}return l(t,Rt),t}(),rr=function(){function e(t,r){i(this,e),this.name="column",this.parent=t,this.box=xe(tr)(r),this.contextUrl=t.parent.box.getHeadPropValue(),this.listUrl=t.box.getHeadPropValue(),this.iterator=St({contextUrl:this.contextUrl,elementBox:this.box})}var t,r,o,u;return a(e,[{key:"get",value:(u=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element[Xt],i=Ve(n)||at(n)?o.getSPObjectCollection(r):o.getSPObject(n,r);return Lt(r,i,t)});case 2:return r=e.sent,n=r.clientContexts,i=r.result,e.next=7,Promise.all(n.map(At));case 7:return e.abrupt("return",Et(i,t));case 8:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"create",value:(o=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element,i=n[Xt];if(wt(i)){var a,u=n.Title,s=void 0===u?i:u,c=n.Type,l=void 0===c?n.TypeAsString||"Text":c,f=n.AllowMultipleValues,h=n.LookupWebId,p=n.LookupList,m=n.LookupField,g=void 0===m?"Title":m,d=n.MaxLength,v=n.RichText,b=n.SchemaXml,y=function(e){return function(t){return r.castTo(t,e)}},x=Re([V(Ke)([V(F(d))([$(/MaxLength="\d+"/)('MaxLength="'.concat(d,'"'))]),V(F(d&&"Text"===l))([F('<Field Type="'.concat(l,'" DisplayName="').concat(s,'" MaxLength="').concat(d,'"/>')),F('<Field Type="'.concat(l,'" DisplayName="').concat(s,'"/>'))])]),(a=o.getSPObjectCollection(r),function(e){return a.addFieldAsXml(e,!0,SP.AddFieldOptions.defaultValue)}),N($t({set_defaultValue:n.DefaultValue,set_description:n.Description,set_direction:n.Direction,set_enforceUniqueValues:n.EnforceUniqueValues,set_fieldTypeKind:n.FieldTypeKind,set_group:n.Group,set_hidden:n.Hidden||void 0,set_indexed:n.Indexed,set_jsLink:n.JsLink,set_objectVersion:n.ObjectVersion,set_readOnlyField:n.ReadOnlyField,set_required:n.Required,set_schemaXml:n.SchemaXml?n.SchemaXml.replace(/\sID="{[^}]+}"/,""):void 0,set_staticName:n.StaticName,set_title:n[Xt],set_typeAsString:n.TypeAsString,set_validationFormula:n.ValidationFormula||void 0,set_validationMessage:n.ValidationMessage||void 0})),Q(F(l))({Text:y(SP.FieldText),Note:Re([y(SP.FieldMultiLineText),N(V(F(v))([ge("set_richText")(!0)]))]),Likes:y(SP.FieldNumber),Number:y(SP.FieldNumber),Boolean:y(SP.Field),Choice:y(f?SP.FieldMultiChoice:SP.FieldChoice),DateTime:y(SP.FieldDateTime),URL:y(SP.FieldUrl),RatingCount:y(SP.FieldRatingScale),AverageRating:y(SP.FieldRatingScale),Lookup:Re([y(SP.FieldLookup),N(Re([ge("set_lookupWebId")(h),ge("set_lookupList")(p),ge("set_lookupField")(g),V(F(f))([ge("set_allowMultipleValues")(!0)])]))]),LookupMulti:Re([y(SP.FieldLookup),N(Re([ge("set_lookupWebId")(h),ge("set_lookupList")(p),ge("set_lookupField")(g),ge("set_allowMultipleValues")(!0)]))]),User:Re([y(SP.FieldUser),N(V(F(f))([ge("set_allowMultipleValues")(!0)]))]),UserMulti:Re([y(SP.FieldUser),N(ge("set_allowMultipleValues")(!0))])}),N(V($e)([me("update")]))])(b);return Lt(r,x,t)}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.box.getCount()){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("create",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"update",value:(r=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element;if(wt(n[Xt])){var i=n.MaxLength,a=n.Title,u=Re([$t({set_defaultValue:n.DefaultValue,set_description:n.Description,set_direction:n.Direction,set_enforceUniqueValues:n.EnforceUniqueValues,set_fieldTypeKind:n.FieldTypeKind,set_group:n.Group,set_hidden:n.Hidden,set_indexed:n.Indexed,set_jsLink:n.JsLink,set_objectVersion:n.ObjectVersion,set_readOnlyField:n.ReadOnlyField,set_required:n.Required,set_schemaXml:n.SchemaXml,set_staticName:n.StaticName,set_title:n[Xt],set_typeAsString:n.TypeAsString,set_validationFormula:n.ValidationFormula,set_validationMessage:n.ValidationMessage}),N(Re([V(F(n.MaxLength))([ge("set_schemaXml")('<Field Type="Text" DisplayName="'.concat(a,'" MaxLength="').concat(i,'"/>'))]),me("update")]))])(o.getSPObject(n[Xt],r));return Lt(r,u,t)}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.box.getCount()){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("update",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"delete",value:(t=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var t=e.clientContext,r=e.element[Xt];if(wt(r))return o.getSPObject(r,t).deleteObject(),r});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.box.getCount()){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("delete",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){return this.getSPObjectCollection(t)[je(e)?"getById":"getByInternalNameOrTitle"](e)}},{key:"getSPObjectCollection",value:function(e){return this.parent.getSPObject(this.listUrl,e).get_fields()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};nt(e,c({},t,{name:this.name,box:this.box,listUrl:this.listUrl,contextUrl:this.contextUrl}))}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),nr=xe(rr),ir={},or=function(e){return M(e)(ir)},ar=ee($e),ur=Re([ar,or(function(e){return function(t){return function(r){var n=v(r),i=n[0],o=n.slice(1);return o.length?t[i]?e(t[i])(o):null:t[i]}}})]),sr=function(e){return Re([ar,or(function(t){return function(r){return function(n){var i=v(n),o=i[0],a=i.slice(1);return a.length?(r[o]||(r[o]={}),t(r[o])(a)):(r[o]=e,e)}}}),F(e)])},cr=(Re([ar,or(function(e){return function(t){return function(r){var n=v(r),i=n[0],o=n.slice(1);return o.length?t[i]?e(t[i])(o):void 0:t?delete t[i]:void 0}}})]),Re([st,lt])),lr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var r;if(Ee(t)){var n=t.Folder,i=t.Columns;r=n||(void 0===i?{}:i).Folder}else Ce(t)&&(r=t);var o=Re([ht,pt,gt])(r);return fr(e)()(o),e}},fr=function e(t){return function(r){return function(n){var i=v(n),o=i[0],a=i.slice(1),u=t,s=r?"".concat(r,"/").concat(o):o;return a.length?(u[s]||(u[s]={}),e(u[s])(s)(a)):(u[s]||(u[s]={}),u)}}},hr=V(Oe)([ie(lr)(),lr()]),pr=H({object:function(e){var t=Object.assign({},e);return Fe(e.Url)&&(t.Url=e.ServerRelativeUrl||e.FileRef),Fe(e.ServerRelativeUrl)&&(t.ServerRelativeUrl=e.Url||e.FileRef),t},string:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r="/"===t?"/":pt(mt(t));return u(e={},"Url",r),u(e,"ServerRelativeUrl",r),e},default:function(){var e;return u(e={},"Url",""),u(e,"ServerRelativeUrl",""),e}}),mr=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,pr,cr))).joinProp="ServerRelativeUrl",r}return l(t,Rt),t}(),gr=function(){function e(t,r){var n=this;i(this,e),this.name="folder",this.parent=t,this.box=xe(mr)(r),this.hasColumns=this.box.some(Ye("Columns")),this.contextUrl=t.parent.box.getHeadPropValue(),this.listUrl=t.box.getHeadPropValue(),this.count=this.box.getCount(),this.iterator=function(e){return St({contextUrl:n.contextUrl,elementBox:n.box,bundleSize:e})}}var t,r,o,s,l;return a(e,[{key:"get",value:(l=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s=this,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=t.asItem?c({},t,{view:["ListItemAllFields"]}):c({},t),n=this.contextUrl,i=this.listUrl,e.next=5,this.iterator()(function(e){var t=e.clientContext,o=e.element,a=kt(n)(i)(o),u=at(a)?s.getSPObjectCollection(a,t):s.getSPObject(a,t);return Lt(t,u,r)});case 5:return o=e.sent,a=o.clientContexts,u=o.result,e.next=10,Promise.all(a.map(At));case 10:return e.abrupt("return",Et(u,r));case 11:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"create",value:(s=n(regeneratorRuntime.mark(function e(){var t,r,i,o,a,s,l,f,h=this,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]?p[0]:{},r=this.contextUrl,i=this.listUrl,o=t.asItem,a=kt(r)(i),s=o?c({},t,{view:["ListItemAllFields"]}):c({},t),!this.hasColumns){e.next=8;break}return e.next=8,this.cacheColumns();case 8:return l=this.box.reduce(function(e){return function(t){return e[a(t)]=t,e}},{}),f=[],e.next=12,M(function(e){return o=n(regeneratorRuntime.mark(function o(p){var m,g,d,v,b,y,x,w,k,_,R;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:m=Object.keys(p),g=[],d=0;case 3:if(!(d<m.length)){o.next=20;break}if(v=m[d],b=l[v],y=void 0,x=void 0,b?(w=b.Columns,y=a(b),x=c({},w,{Title:dt(y)})):x={Title:dt(y=v)},k=Tt(r),wt(y)){o.next=12;break}return o.abrupt("return",void 0);case 12:(_=we(SP.ListItemCreationInformation)).set_underlyingObjectType(SP.FileSystemObjectType.folder),_.set_leafName(y),R=Ht(ur(["columns",r,i])||{})(x)(h.parent.getSPObject(i,k).addItem(_)),g.push(Ft(k,R.get_folder(),s).catch(A));case 17:d+=1,o.next=3;break;case 20:return o.t0=Et,o.next=23,Promise.all(g);case 23:return o.t1=Ge,o.t2=o.sent.filter(o.t1),o.t3=t,(0,o.t0)(o.t2,o.t3).reduce(function(e,t){return l[a(u({},"Url",t.ServerRelativeUrl||t.FileRef))]&&e.push(t),e},f),o.abrupt("return",Promise.all(m.map(function(){var t=n(regeneratorRuntime.mark(function t(r){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=p[r],t.abrupt("return",We(n)&&e(n));case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())));case 29:case"end":return o.stop()}},o)})),function(e){return o.apply(this,arguments)};var o})(hr(this.box.getIterable().map(a)));case 12:return nt("create",c({},t,{name:this.name,box:xe(mr)(f),listUrl:this.listUrl,contextUrl:this.contextUrl})),e.abrupt("return",this.box.isArray()?f:f[0]);case 14:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"update",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s=this,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=this.contextUrl,n=this.listUrl,i=t.asItem?c({},t,{view:["ListItemAllFields"]}):c({},t),e.next=5,this.cacheColumns();case 5:return e.next=7,this.iterator(82)(function(e){var t=e.clientContext,o=e.element,a=kt(r)(n)(o),u=o.Columns,c=void 0===u?{}:u,l=o.WelcomePage,f=s.getSPObject(a,t);return We(c)&&Ht(ur(["columns",r,n]))(Object.assign({},c))(f.get_listItemAllFields()),Me(l)&&(f.set_welcomePage(l),f.update()),Lt(t,f,i)});case 7:if(o=e.sent,a=o.clientContexts,u=o.result,!this.count){e.next=13;break}return e.next=13,Promise.all(a.map(At));case 13:return this.report("update",t),e.abrupt("return",Et(u,t));case 15:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"delete",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s=this,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=t.noRecycle,n=this.contextUrl,i=this.listUrl,e.next=5,this.iterator(240)(function(e){var t=e.clientContext,o=e.element,a=kt(n)(i)(o);if(wt(a)){var u=s.getSPObject(a,t);return u.isRoot||me(r?"deleteObject":"recycle")(u),a}});case 5:if(o=e.sent,a=o.clientContexts,u=o.result,!this.count){e.next=11;break}return e.next=11,Promise.all(a.map(At));case 11:return this.report(r?"delete":"recycle",t),e.abrupt("return",Et(u,t));case 13:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){var r,n=this.parent.getSPObject(this.listUrl,t);if(e)r=Qt(e)(n.get_rootFolder());else{var i=n.get_rootFolder();i.isRoot=!0,r=i}return r}},{key:"getSPObjectCollection",value:function(e,t){return this.getSPObject(ht(e),t).get_folders()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};nt(e,c({},t,{name:this.name,box:this.box,listUrl:this.listUrl,contextUrl:this.contextUrl}))}},{key:"cacheColumns",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.contextUrl,r=this.listUrl,ur(["columns",t,r])){e.next=6;break}return e.next=4,this.parent.column().get({view:["TypeAsString","InternalName","Title","Sealed"],mapBy:"InternalName"});case 4:n=e.sent,sr(n)(["columns",t,r]);case 6:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),dr=xe(gr),vr="Url";function br(e){return yr.apply(this,arguments)}function yr(){return(yr=n(regeneratorRuntime.mark(function e(t){var r,i,o,a=this,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},i=this.contextUrl,o=this.listUrl,e.next=4,this.iteratorREST(function(){var e=n(regeneratorRuntime.mark(function e(n){var s,c,l,f,h,p,m,g,d,v,b,y,x,w,k,_,R,S,U,P,T,C,O,E,j;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.element,c=s.To,l=s.OnlyContent,f=kt(i)(o)(s),ut(f)){e.next=5;break}return e.abrupt("return");case 5:if(Ee(c)?(h=c.WebUrl||i,p=c.ListUrl,m=kt(c.WebUrl)(c.ListUrl)(c)||""):(h=i,p=o,m=c),h){e.next=8;break}throw new Error("Target WebUrl is missed");case 8:if(p){e.next=10;break}throw new Error("Target ListUrl is missed");case 10:if(f){e.next=12;break}throw new Error("Source file Url is missed");case 12:if(g=a.parent.of(o),d=g.file(f),v=a.parent.parent.of(h).library(p),b=ut(m)?m:"".concat(m,"/").concat(xt(f)),y={},x={},l){e.next=25;break}return e.next=21,d.get({asItem:!0});case 21:for(w=e.sent,k=Reflect.ownKeys(w),_=0;_<k.length;_+=1)R=k[_],I[R]||null===w[R]||(y[R]=w[R]);if(Object.keys(y).length)for(S=Reflect.ownKeys(y),U=0;U<S.length;U+=1)P=S[U],x[P]=w[P];case 25:if(r.forced||i!==h){e.next=39;break}if(C=Tt(i),O=a.getSPObject(f,C),!(E=yt(m))){e.next=32;break}return e.next=32,a.parent.folder(E).create({silentInfo:!0,expanded:!0,view:["Name"]}).catch(A);case 32:return O[t?"moveTo":"copyTo"](mt("".concat(p,"/").concat(b))),e.next=35,Ft(C,O,r);case 35:return e.next=37,v.file((T={},u(T,vr,m),u(T,"Columns",x),T)).update({silentInfo:!0});case 37:e.next=58;break;case 39:return e.t0=v,u(j={},vr,b),e.t1=u,e.t2=j,e.next=46,g.file(f).get({asBlob:!0});case 46:return e.t3=e.sent,(0,e.t1)(e.t2,"Content",e.t3),u(j,"OnProgress",s.OnProgress),u(j,"Overwrite",s.Overwrite),u(j,"Columns",x),e.t4=j,e.t5={silentInfo:!0},e.next=55,e.t0.file.call(e.t0,e.t4).create(e.t5);case 55:if(!t){e.next=58;break}return e.next=58,d.delete();case 58:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:console.log("".concat(O[t?"move":"copy"]," ").concat(this.count," ").concat(this.name,"(s)"));case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var xr=Re([st,lt]),wr=H({object:function(e){var t=Object.assign({},e),r=e.Content?e.Content.name:void 0;return e[vr]||(t[vr]=e.ServerRelativeUrl||e.FileRef||r),e.ServerRelativeUrl||(t.ServerRelativeUrl=e[vr]||e.FileRef),t},string:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r="/"===t?"/":pt(mt(t));return u(e={},vr,r),u(e,"ServerRelativeUrl",r),e},default:function(){var e;return u(e={},vr,""),u(e,"ServerRelativeUrl",""),e}});function kr(e){return _r.apply(this,arguments)}function _r(){return(_r=n(regeneratorRuntime.mark(function e(r){var n,i,o,a,s,l,f,h,p,m,g,d,v,b,y=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.length>1&&void 0!==y[1]?y[1]:{},i=n.needResponse,o=r.Content,a=void 0===o?"":o,s=r.Overwrite,l=void 0===s||s,f=r.Columns,h=this.contextUrl,p=this.listUrl,m=kt(h)(p)(r),g=xt(m),d=this.getRESTObjectCollection(m,p,h),e.t0=t,e.t1="".concat(d,"/add(url='").concat(g,"',overwrite=").concat(l,")"),e.next=11,Kt();case 11:return e.t2=e.sent,e.t3={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":e.t2},e.t4=a,e.t5={url:e.t1,headers:e.t3,method:"POST",data:e.t4},e.next=17,(0,e.t0)(e.t5);case 17:if(v=r,!f){e.next=24;break}return e.next=21,this.of((b={},u(b,vr,m),u(b,"Columns",f),b)).update(c({},n,{silentInfo:!0}));case 21:v=e.sent,e.next=28;break;case 24:if(!i){e.next=28;break}return e.next=27,this.of(m).get(n);case 27:v=e.sent;case 28:return e.abrupt("return",v);case 29:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Rr(e){return Sr.apply(this,arguments)}function Sr(){return(Sr=n(regeneratorRuntime.mark(function e(r){var n,i,o,a,s,l,f,h,p,m,g,d,v,b,y,x,w,k,_,R,S,U,P,T,C,O,E,I,j,L,F,M,B=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=B.length>1&&void 0!==B[1]?B[1]:{},i=n.needResponse,o=n.silent,a=n.silentErrors,s=r.Content,l=void 0===s?"":s,f=r.Overwrite,h=void 0===f||f,p=r.OnProgress,m=void 0===p?A:p,g=r.Folder,d=void 0===g?"":g,v=r.Columns,b=this.contextUrl,y=this.listUrl,x=kt(b)(y)(r),w=d||yt(x),k=x?xt(x):l.name,_={__REQUESTDIGEST:!0,__VIEWSTATE:!0,__EVENTVALIDATION:!0},R=[],S=ur(["listGUIDs",b,y]),U=ur(["listFormMatches",b,y]),T=(P=/<input[^<]*\/>/g).exec(U);T;)C=T[0],O=C.match(/id="([^"]+)"/)[1],_[O]&&R.push(C),T=P.exec(U);return(E=window.document.createElement("form")).innerHTML=te("")(R),(I=new FormData(E)).append("__EVENTTARGET","ctl00$PlaceHolderMain$ctl03$RptControls$btnOK"),I.append("ctl00$PlaceHolderMain$ctl04$ctl01$uploadLocation","/".concat(w.replace(/^\//,""))),h&&I.append("ctl00$PlaceHolderMain$UploadDocumentSection$ctl05$OverwriteSingle",!0),I.append("ctl00$PlaceHolderMain$UploadDocumentSection$ctl05$InputFile",l,k),e.next=23,t({url:"/".concat(b,"/_layouts/15/UploadEx.aspx?List={").concat(S,"}"),method:"POST",data:I,onUploadProgress:function(e){return m(Math.floor(100*e.loaded/e.total))}});case 23:if(j=e.sent,L=j.data.match(/id="ctl00_PlaceHolderMain_LabelMessage">([^<]*)<\/span>/),F=u({},vr,x),!Oe(L)){e.next=30;break}o||a||console.error(L[1]),e.next=40;break;case 30:if(!We(v)){e.next=36;break}return e.next=33,this.of((M={},u(M,vr,x),u(M,"Columns",v),M)).update(c({},n,{silentInfo:!0}));case 33:F=e.sent,e.next=40;break;case 36:if(!i){e.next=40;break}return e.next=39,this.of(u({},vr,x)).get(n);case 39:F=e.sent;case 40:return e.abrupt("return",F);case 41:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Ur,Pr,Tr,Cr,Or=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,wr,xr))).joinProp="ServerRelativeUrl",r}return l(t,Rt),a(t,[{key:"getCount",value:function(){return this.isArray()?ct(this.value).length:ut(this.value[this.prop])?1:0}}]),t}(),Er=function(){function e(t,r){i(this,e),this.name="file",this.parent=t,this.box=xe(Or)(r),this.count=this.box.getCount(),this.contextUrl=t.parent.box.getHeadPropValue(),this.listUrl=t.box.getHeadPropValue(),this.iterator=St({contextUrl:this.contextUrl,elementBox:this.box}),this.iteratorREST=Ut({elementBox:this.box})}var r,o,u,s,l,f,h;return a(e,[{key:"get",value:(h=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s,l=this,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:{},r=this.contextUrl,n=this.listUrl,!t.asBlob){e.next=7;break}return e.next=5,this.iteratorREST(function(e){var t=e.element,i=kt(r)(n)(t);return Mt(r,{url:"".concat(l.getRESTObject(i,n,r),"/$value"),binaryStringResponseBody:!0})});case 5:return i=e.sent,e.abrupt("return",It(i,t));case 7:return o=t.asItem?c({},t,{view:["ListItemAllFields"]}):c({},t),e.next=10,this.iterator(function(e){var t=e.clientContext,i=e.element,a=kt(r)(n)(i),u=$e(a)&&at(a)?l.getSPObjectCollection(a,t):l.getSPObject(a,t);return Lt(t,u,o)});case 10:return a=e.sent,u=a.clientContexts,s=a.result,e.next=15,Promise.all(u.map(At));case 15:return e.abrupt("return",Et(s,o));case 16:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"create",value:(f=n(regeneratorRuntime.mark(function e(){var r,i,o,a,u,s,l,f=this,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>0&&void 0!==h[0]?h[0]:{},i=this.contextUrl,o=this.listUrl,ur(["listGUIDs",i,o])){e.next=7;break}return e.next=5,this.parent.of(o).get({view:"Id"});case 5:a=e.sent,sr(a.Id.toString())(["listGUIDs",i,o]);case 7:if(ur(["listFormMatches",i,o])){e.next=12;break}return e.next=10,t.get("/".concat(i,"/_layouts/15/Upload.aspx?List={").concat(ur(["listGUIDs",i,o]),"}"));case 10:u=e.sent,sr(u.data.match(/<form(\w|\W)*<\/form>/))(["listFormMatches",i,o]);case 12:if(!(s=this.box.reduce(function(e){return function(t){var r=t.Folder,n=bt(_t(i)(t))||r;return n&&e.push(n),e}})).length){e.next=16;break}return e.next=16,this.parent.folder(s).get({view:"ServerRelativeUrl"}).catch(n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.parent.folder(s).create({silent:!0});case 2:case"end":return e.stop()}},e)})));case 16:return e.next=18,this.iteratorREST(function(e){var t=e.element,n=kt(i)(o)(t);if(ut(n)||!t.Content||t.Content.name)return Ie(t.Content)?Rr.call(f,t,r):kr.call(f,t,r)});case 18:return l=e.sent,nt("create",c({},r,{name:this.name,box:xe(Or)(l),listUrl:this.listUrl,contextUrl:this.contextUrl})),e.abrupt("return",l);case 21:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"update",value:(l=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s=this,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=this.contextUrl,n=this.listUrl,i=t.asItem?c({},t,{view:["ListItemAllFields"]}):c({},t),e.next=5,this.cacheColumns();case 5:return e.next=7,this.iterator(function(e){var t=e.clientContext,o=e.element,a=o.Content,u=o.Columns,c=kt(r)(n)(o);if(ut(c)){var l;if(Fe(a))l=Ht(ur(["columns",r,n]))(Object.assign({},u))(s.getSPObject(c,t).get_listItemAllFields());else{for(var f={},h=Reflect.ownKeys(u),p=0;p<h.length;p+=1){var m=h[p],g=u[m];f[m]=V(Oe)([te(";#;#")])(g)}var d=we(SP.FileSaveBinaryInformation);$t({set_content:Dt(a),set_fieldValues:f})(d),(l=s.getSPObject(c,t)).saveBinary(d),l=l.get_listItemAllFields()}return Lt(t,l.get_file(),i)}});case 7:if(o=e.sent,a=o.clientContexts,u=o.result,!this.count){e.next=13;break}return e.next=13,Promise.all(a.map(At));case 13:return this.report("update",i),e.abrupt("return",Et(u,i));case 15:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"delete",value:(s=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s=this,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=this.contextUrl,n=this.listUrl,i=t.noRecycle,e.next=5,this.iterator(function(e){var t=e.clientContext,o=e.element,a=kt(r)(n)(o);if(ut(a)){var u=s.getSPObject(a,t);return me(i?"deleteObject":"recycle")(u),a}});case 5:if(o=e.sent,a=o.clientContexts,u=o.result,!this.count){e.next=11;break}return e.next=11,Promise.all(a.map(At));case 11:return this.report(i?"delete":"recycle",t),e.abrupt("return",Et(u,t));case 13:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"copy",value:(u=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",br.call(this,!1,t));case 1:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"move",value:(o=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",br.call(this,!0,t));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){var r=xt(e),n=yt(e),i=this.getRootFolder(t);return n?Qt(n)(i).get_files().getByUrl(r):i.get_files().getByUrl(r)}},{key:"getSPObjectCollection",value:function(e,t){var r=yt(ht(e)),n=this.getRootFolder(t);return r?Qt(r)(n).get_files():n.get_files()}},{key:"getRootFolder",value:function(e){return this.parent.getSPObject(this.listUrl,e).get_rootFolder()}},{key:"getRESTObject",value:function(e,t,r){var n=e;return/'/.test(e)&&(n=n.replace(/'/,"%27%27")),mt("".concat(this.getRESTObjectCollection(e,t,r),"/getbyurl('").concat(xt(n),"')"))}},{key:"getRESTObjectCollection",value:function(e,t,r){var n=yt(e),i="";n&&(i=mt(n).split("/").reduce(function(e,t){return"".concat(e,"/folders/getbyurl('").concat(t,"')")},""));return mt("/".concat(r,"/_api/web/lists/getbytitle('").concat(t,"')/rootfolder").concat(i,"/files"))}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};nt(e,c({},t,{name:this.name,box:this.box,listUrl:this.listUrl,contextUrl:this.contextUrl}))}},{key:"cacheColumns",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.contextUrl,r=this.listUrl,ur(["columns",t,r])){e.next=6;break}return e.next=4,this.parent.column().get({view:["TypeAsString","InternalName","Title","Sealed"],mapBy:"InternalName"});case 4:n=e.sent,sr(n)(["columns",t,r]);case 6:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),Ir=xe(Er),jr=new RegExp("\\s(&&||||and|or)\\s","i"),Lr=new RegExp("\\((.*".concat("\\s(&&||||and|or)\\s",".*)\\)"),"i"),Ar=/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z$/,Fr={AppAuthor:"lookup",AppEditor:"lookup",Attachments:"attachments",Author:"lookup",BaseName:"computed",ContentType:"computed",ContentTypeId:"contentTypeId",Created:"dateTime",Created_x0020_Date:"lookup",DocIcon:"computed",Edit:"computed",Editor:"lookup",EncodedAbsUrl:"computed",FSObjType:"number",FileDirRef:"lookup",FileLeafRef:"file",FileRef:"file",File_x0020_Type:"text",FolderChildCount:"number",GUID:"guid",HTML_x0020_Type:"computed",ID:"counter",InstanceID:"integer",ItemChildCount:"number",Last_x0020_Modified:"lookup",LinkFilename:"computed",LinkFilename2:"computed",LinkFilenameNoMenu:"computed",LinkTitle:"computed",LinkTitle2:"computed",LinkTitleNoMenu:"computed",MetaInfo:"lookup",Modified:"dateTime",Order:"number",PermMask:"computed",ProgId:"lookup",ScopeId:"lookup",SelectTitle:"computed",ServerUrl:"computed",SortBehavior:"lookup",SyncClientId:"lookup",Title:"text",UniqueId:"lookup",WorkflowInstanceID:"guid",WorkflowVersion:"integer",_CopySource:"text",_EditMenuTableEnd:"computed",_EditMenuTableStart:"computed",_EditMenuTableStart2:"computed",_HasCopyDestinations:"Boolean",_IsCurrentVersion:"Boolean",_Level:"integer",_ModerationComments:"note",_ModerationStatus:"modStat",_UIVersion:"integer",_UIVersionString:"text"},Mr=/(Text|Note|Number|Integer|Counter|Boolean|DateTime|Date|Time|Computed|Currency|ModStat|Guid|File|Attachments|Lookup|LookupMulti|User|UserMulti|TaxonomyFieldType|TaxonomyFieldTypeMulti|Url)\s/i,Br=/\s(eq|neq|geq|leq|gt|lt|isnull|isnotnull|contains|beginsWith|includes|notincludes|search|in|membership)(\s|$)/i,Nr={text:"Text",note:"Text",number:"Number",integer:"Text",counter:"Text",boolean:"Boolean",lookup:"Lookup",lookupmulti:"Lookup",user:"Text",usermulti:"Text",datetime:"Text",date:"Text",time:"Text",currency:"Text",computed:"Text",modstat:"ModStat",guid:"Guid",file:"File",attachments:"Attachments",taxonomyfieldtype:"TaxonomyFieldType",taxonomyfieldtypemulti:"TaxonomyFieldTypeMulti",url:"Url"},Dr={eq:"Eq",neq:"Neq",geq:"Geq",leq:"Leq",gt:"Gt",lt:"Lt",isnull:"IsNull",isnotnull:"IsNotNull",beginswith:"BeginsWith",contains:"Contains",includes:"Includes",notincludes:"NotIncludes",in:"In",membership:"Membership",search:"Search"},Vr={user:"SPWeb.Users",users:"SPWeb.AllUsers",group:"CurrentUserGroups",groups:"SPWeb.Groups"},Qr={"&&":"And","||":"Or"},Hr=function(e){return Qr[e]||(/^and$/i.test(e)?"And":"Or")},qr=function(e){var t=e.match(new RegExp("^[^\\(]*\\((.*".concat(jr.test(e)?"".concat("\\s(&&||||and|or)\\s",".*"):"",")\\)[^\\)]*$"),"i"));return t&&t[1]?t[1]:e},Wr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("("===e[0]&&")"===e.substr(-1)){var t=K(/\(/g)(e).length;if(t!==K(/\)/g)(e).length)throw new Error("query has wrong braces");return t>=K(new RegExp("\\s(&&||||and|or)\\s","ig"))(e).length?qr(e):e}return e},Gr=function(e){var t,r,n,i="",o="",a=e.match(Br);if(!a)throw new SyntaxError('Wrong operator in "'.concat(e,'"'));r=d(a,1)[0],t=a[1].toLowerCase();var u=Dr[t],s=e.split(new RegExp(r,"i")),c=s[0].replace(/\s\s+/g," ").trim();if(Mr.test(c)){var l=c.split(" ");n=l.shift().toLowerCase(),c=l.join(" ")}else n=Fr[c]||"text";var f=s[1];switch(n){case"datetime":case"time":case"date":o='StorageTZ="True"',"date"!==n&&(o+=' IncludeTimeValue="True"'),f=new Date(f).toISOString();break;case"text":Ar.test(f)&&(o='StorageTZ="True"');break;case"boolean":f=/^(true|yes|1)$/.test(f)?"1":"0";break;case"user":case"usermulti":case"lookup":case"lookupmulti":case"taxonomyfieldtype":case"taxonomyfieldtypemulti":i=' LookupId="True"'}var h=Nr[n];switch("text"!==n&&(f=f.trim()),t){case"in":var p=[],m=[];f=f.split(f.indexOf("_DELIMITER_")>=0?"_DELIMITER_":",");for(var g=0;g<f.length;g+=1){var v=f[g];p.push('<Value Type="'.concat(h,'"').concat(o,">").concat($r(v),"</Value>"))}if(f.length>500){for(var b=fe(500)(p),y=b.length-1;y>=0;y-=1)m.push('<In><FieldRef Name="'.concat(c,'"').concat(i,"/><Values>").concat(b[y].join(""),"</Values></In>"));for(var x='<IsNull><FieldRef Name="ID"/></IsNull>',w=0;w<m.length;w+=1){var k=m[w];x="<Or>".concat(k).concat(x,"</Or>")}return x}return'<In><FieldRef Name="'.concat(c,'"').concat(i,"/><Values>").concat(p.join(""),"</Values></In>");case"search":return Re([$(/\s+/g)(" "),z,J(" "),Z(function(e){return"".concat(n," ").concat(c," contains ").concat(e)}),en(),Kr])(f);case"membership":var _=Vr[f.toLowerCase()];return"<".concat(u,' Type="').concat(_,'"><FieldRef Name="').concat(c,'"/></').concat(u,">")}var R=/null/.test(t)?"":'<Value Type="'.concat(h,'"').concat(o,">").concat($r(f),"</Value>");return"<".concat(u,'><FieldRef Name="').concat(c,'"').concat(i,"/>").concat(R,"</").concat(u,">")},$r=function(e){return/^"[^"]*"$/.test(e)?e.slice(1,-1):e},Kr=function e(t){var r,n,i,o="",a=!1,u=!1,s=0;if(Lr.test(t))for(var c=0,l=0;l<t.length;l+=1){var f=t[l];"("===f?(s||(a=!0),c+=1):")"===f?(s&&(u=!0),c-=1):c||(o=o.concat(f),s||(s=l))}if(o&&a&&u)i=o.trim(),r=Wr(t.slice(0,s)),n=Wr(t.slice(s+o.length));else{var h=Wr(t).match(Lr);if(h){var p=new RegExp("_dummy_"),m=h[1],g=t.replace(m,"_dummy_").split(jr),v=g[0];if(3!==g.length)return Gr(v);i=d(g,2)[1];var b=g[2];p.test(v)?(r=qr(v.replace("_dummy_",m)),n=b):p.test(b)&&(r=v,n=qr(b.replace("_dummy_",m)))}else{var y=t.split(jr);if(r=d(y,1)[0],3!==y.length)return Gr(r);n=d(y,3)[2],i=d(y,2)[1]}}var x=Hr(i);return"<".concat(x,">").concat(e(r)).concat(e(n),"</").concat(x,">")},Yr=function e(t){switch(j(t)){case"number":return e("ID eq ".concat(t));case"object":return zr(t);case"string":if(t){if(t===(+t).toString())return e("ID eq ".concat(t));if(G(/\s/)(t)&&J(/\s/)(t).length>1){var r=Wr(t.replace(/\s{2,}/g," ").replace(/^\s|\s$/g,""));if(J(/\s/)(r).length>1)return/^<|>$/.test(r)?t:jr.test(r)?Kr(r):Gr(r)}}return"";default:return""}},Jr=function(e){return/allItems/i.test(e)?' Scope="Recursive"':/^items$/i.test(e)?' Scope="FilesOnly"':/^all$/i.test(e)?' Scope="RecursiveAll"':""},zr=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r="",n="",i=t.OrderBy,o=t.Scope,a=t.Limit,u=t.Query,s=void 0===u?"":u;if(!Ee(t)){if(Qe(t)&&/<view/i.test(t))return t;s=t}if(i){e=X(i);for(var c=0;c<e.length;c+=1){var l=e[c];r+='<FieldRef Name="'.concat(l.split(">")[0],'"').concat(/>/.test(l)?' Ascending="FALSE"':"","/>")}r="<OrderBy>".concat(r,"</OrderBy>")}o&&(n=Jr(o));var f=s?"<Where>".concat(Yr(s),"</Where>"):"",h=f||r?"<Query>".concat(f).concat(r,"</Query>"):"",p="<RowLimit>".concat(a||16e4,"</RowLimit>");return"<View".concat(n,">").concat(h).concat(p,"</View>")},Xr=function(e){var t=e.joiner,r=void 0===t?"||":t,n=e.operator,i=void 0===n?void 0===a?"isnotnull":"eq":n,o=e.columns,a=e.values,u=Hr(r),s=X(o),c=X(a),l="ID ".concat("And"===u?Dr.isnotnull:Dr.isnull);if(c.length)for(var f=s.length-1;f>=0;f-=1)for(var h=c.length-1;h>=0;h-=1)l="(".concat(s[f]," ","".concat(i," ").concat(c[h])," ").concat(u," ").concat(l,")");else for(var p=s.length-1;p>=0;p-=1)l="(".concat(s[p]," ").concat(i," ").concat(u," ").concat(l,")");return Wr(l)},Zr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"||";return function(t){return function(r){var n=Hr(e),i="ID ".concat("And"===n?Dr.isnotnull:Dr.isnull);if(t){var o=Wr(t);if(r){var a=Wr(r);return jr.test(o)?jr.test(a)?"(".concat(o,") ").concat(n," (").concat(a,")"):"(".concat(o,") ").concat(n," ").concat(a):jr.test(a)?"".concat(o," ").concat(n," (").concat(a,")"):"".concat(o," ").concat(n," ").concat(a)}return jr.test(o)?"(".concat(o,") ").concat(n," ").concat(i):"".concat(o," ").concat(n," ").concat(i)}if(r){var u=Wr(r);return jr.test(u)?"".concat(i," ").concat(n," (").concat(u,")"):"".concat(i," ").concat(n," ").concat(u)}return"(".concat(i,") ").concat(n," ").concat(i)}}},en=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"||";return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return ie(Zr(e))(ae(t))(ue(t))}},tn=function(e){return console.log(e&&DOMParser?(new DOMParser).parseFromString(e,"text/xml"):e)},rn=H({object:function(e){return Object.assign({},e)},string:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return u({},"Url",e)},default:function(){return u({},"Url","/")}}),nn=function(){function e(t,r){i(this,e),this.name="attachment",this.parent=t,this.box=xe(Rt)(r,rn),this.item=t.box.getHead(),this.iterator=St({contextUrl:t.parent.contextUrl,elementBox:this.box})}var t;return a(e,[{key:"get",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var r=e.clientContext,n=e.element;return Lt(r,o.getSPObject(n,r),t)});case 3:return r=e.sent,n=r.clientContexts,i=r.result,e.next=8,Promise.all(n.map(At));case 8:return e.abrupt("return",Et(i,t));case 9:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){var r=e.Url,n=this.getSPObjectCollection(t);return r&&"/"!==r?n.getByFileName(r):n}},{key:"getSPObjectCollection",value:function(e){return this.parent.getSPObject(this.item,e).get_attachmentFiles()}}]),e}(),on=xe(nn),an="ID",un=H({object:function(e){return Object.assign({},e)},string:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return u({},an,e)},number:function(e){return u({},an,e)},default:function(){return u({},an,void 0)}}),sn=function(e){var t;return e.Columns?t=Object.assign({},e.Columns):(delete(t=Object.assign({},e)).Folder,delete t[an]),!!Object.keys(t).length},cn=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,un))).prop=an,r.joinProp=an,r}return l(t,Rt),a(t,[{key:"getCount",value:function(e){return Oe(this.value)?"create"===e?this.value.filter(sn).length:this.value.length:"create"===e?sn(this.value)?1:0:1}}]),t}(),ln=function(){function t(e,r){i(this,t),this.name="item",this.parent=e,this.box=xe(cn)(r),this.contextUrl=e.parent.box.getHeadPropValue(),this.listUrl=e.box.getHeadPropValue(),this.listFolder="list"===e.name?"Lists/":"",this.getListSPObject=e.getSPObject.bind(e),this.iterator=St({contextUrl:e.contextUrl,elementBox:this.box})}var r,o,u,s,l,f,h,p,m,g,v,y,x,w,k;return a(t,[{key:"get",value:(k=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.showCaml,e.next=4,this.iterator(function(e){var n=e.clientContext,i=e.element,o=a.getSPObject(i,n);return r&&o.camlQuery&&tn(o.camlQuery.get_viewXml()),Lt(n,o,t)});case 4:return n=e.sent,i=n.clientContexts,o=n.result,e.next=9,Promise.all(i.map(At));case 9:return e.abrupt("return",Et(o,t));case 10:case"end":return e.stop()}},e,this)})),function(){return k.apply(this,arguments)})},{key:"create",value:(w=n(regeneratorRuntime.mark(function e(){var t,r,i,o,a,u,s,l,f=this,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:{},"list"===this.parent.name){e.next=3;break}throw new Error('There is no "create" method in "item" module. Use "file" module instead of "item".');case 3:return r=this.contextUrl,i=this.listUrl,e.next=6,this.cacheColumns();case 6:if(!(o=this.box.reduce(function(e){return function(t){var r=t.Folder;return r&&e.push(r),e}})).length){e.next=10;break}return e.next=10,this.parent.folder(o).get({view:"ServerRelativeUrl"}).catch(n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.parent.folder(o).create({silent:!0});case 2:case"end":return e.stop()}},e)})));case 10:return e.next=12,this.iterator(function(e){var n,o=e.clientContext,a=e.element,u=we(SP.ListItemCreationInformation),s=f.getListSPObject(i,o),l=a.Folder,h=a.Columns,p=l;if(We(h)?(h.Folder&&(p=h.Folder),n=c({},h)):(delete(n=c({},a))[an],delete n.Folder),We(n)){if(p){var m=kt(r)(i)({Folder:p});u.set_folderUrl("/".concat(r,"/Lists/").concat(i,"/").concat(m))}var g=Ht(ur(["columns",r,i]))(n)(s.addItem(u));return Lt(o,g,t)}});case 12:if(a=e.sent,u=a.clientContexts,s=a.result,!this.box.getCount()){e.next=23;break}l=0;case 17:if(!(l<u.length)){e.next=23;break}return e.next=20,At(u[l]);case 20:l+=1,e.next=17;break;case 23:return this.report("create",t),e.abrupt("return",Et(s,t));case 25:case"end":return e.stop()}},e,this)})),function(){return w.apply(this,arguments)})},{key:"update",value:(x=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.contextUrl,n=this.listUrl,e.next=3,this.cacheColumns();case 3:return e.next=5,this.iterator(function(e){var i=e.clientContext,o=e.element;if(o[an]){var a=Object.assign({},o);delete a[an];var s=Ht(ur(["columns",r,n]))(a)(u.getSPObject(o,i));return Lt(i,s,t)}});case 5:if(i=e.sent,o=i.clientContexts,a=i.result,!Ke(a)){e.next=11;break}return e.next=11,Promise.all(o.map(At));case 11:return this.report("update",t),e.abrupt("return",Et(a,t));case 13:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)})},{key:"updateByQuery",value:(y=n(regeneratorRuntime.mark(function e(t){var r,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,i,a,u,s,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.element,i=n.Folder,a=n.Query,u=n.Columns,s=void 0===u?{}:u,void 0!==a){e.next=4;break}throw new Error("Query is missed");case 4:return e.next=6,o.of({Folder:i,Query:a}).get(c({},t,{expanded:!1}));case 6:if(!(l=e.sent).length){e.next=10;break}return f=l.map(function(e){var t=c({},s);return t[an]=e[an],t}),e.abrupt("return",o.of(f).update(t));case 10:return e.abrupt("return",void 0);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return r=e.sent,i=r.result,e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"delete",value:(v=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s=this,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=t.noRecycle,n=t.isSerial,e.next=4,this.iterator(function(e){var t=e.clientContext,n=e.element,i=n[an];if(i){var o=s.getSPObject(n,t);return o.isRoot||me(r?"deleteObject":"recycle")(o),i}});case 4:if(i=e.sent,o=i.clientContexts,a=i.result,!this.box.getCount()){e.next=20;break}if(!n){e.next=18;break}u=0;case 10:if(!(u<o.length)){e.next=16;break}return e.next=13,At(o[u]);case 13:u+=1,e.next=10;break;case 16:e.next=20;break;case 18:return e.next=20,Promise.all(o.map(At));case 20:return this.report(r?"delete":"recycle",t),e.abrupt("return",Et(a,t));case 22:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)})},{key:"deleteByQuery",value:(g=n(regeneratorRuntime.mark(function e(t){var r,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=r.element)){e.next=3;break}throw new Error("Query is missed");case 3:return e.next=5,o.of(n).get(t);case 5:if(!(i=e.sent).length){e.next=10;break}return e.next=9,o.of(i.map(be("ID"))).delete({isSerial:!0});case 9:return e.abrupt("return",i);case 10:return e.abrupt("return",void 0);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return r=e.sent,i=r.result,e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"getDuplicates",value:(m=n(regeneratorRuntime.mark(function t(){var r,n,i,o,a,u,s,c,l,f,h,p,m=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.of({Scope:"allItems",Limit:1e5}).get({view:["ID","FSObjType","Modified"].concat(b(this.box.getIterable().map(function(e){return e[an]})))});case 2:for(r=t.sent,n=function(t){var r=[];return m.box.chain(function(e){var n=t[e[an]];$e(n)&&r.push(n.get_lookupId?n.get_lookupId():n)}),e.MD5(r.join(".")).toString()},i=r.reduce(function(e,t){var r=n(t);return e.has(r)||e.set(r,[]),e.get(r).push(t),e},new Map),o=[],a=!0,u=!1,s=void 0,t.prev=9,c=i[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)f=l.value,h=d(f,2),(p=h[1]).length>1&&o.push(p.sort(function(e,t){return e.Modified.getTime()-t.Modified.getTime()}));t.next=17;break;case 13:t.prev=13,t.t0=t.catch(9),u=!0,s=t.t0;case 17:t.prev=17,t.prev=18,a||null==c.return||c.return();case 20:if(t.prev=20,!u){t.next=23;break}throw s;case 23:return t.finish(20);case 24:return t.finish(17);case 25:return t.abrupt("return",o.map(ce));case 26:case"end":return t.stop()}},t,this,[[9,13,17,25],[18,,20,24]])})),function(){return m.apply(this,arguments)})},{key:"deleteDuplicates",value:(p=n(regeneratorRuntime.mark(function e(){var t,r,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,this.getDuplicates();case 3:return r=e.sent,e.next=6,this.of(b(r.reduce(function(e,t){return e.concat(t.map(be("ID")))},[]))).delete(c({},t,{isSerial:!0}));case 6:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})},{key:"getEmpties",value:(h=n(regeneratorRuntime.mark(function e(t){var r,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.box.value.map(be("ID")),e.next=3,this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(n){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.element,e.abrupt("return",a.of({Query:Xr({operator:"isnull",columns:r}),Scope:"allItems",Limit:1e5,Folder:i.Folder}).get(t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return i=e.sent,o=i.result,e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"deleteEmpties",value:(f=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.box.value.map(be("ID")),e.t0=this,e.next=4,this.of(r).getEmpties(t);case 4:return e.t1=e.sent,e.t2=be("ID"),e.t3={isSerial:!0},e.next=9,e.t0.of.call(e.t0,e.t1).map(e.t2).delete(e.t3);case 9:return n=e.sent,i=n.result,e.abrupt("return",i);case 12:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"merge",value:(l=n(regeneratorRuntime.mark(function e(t){var r,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.contextUrl,i=this.listUrl,this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(a){var u,s,c,l,f,h,p,m,g,v,b,y,x,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=a.element,s=u.Key,c=u.Forced,l=u.To,f=u.From,h=u.Mediator,p=void 0===h?function(){return A}:h,s){e.next=4;break}throw new Error("Key is missed");case 4:if(m=f.Column){e.next=7;break}throw new Error("From Column is missed");case 7:if(g=l.Column){e.next=10;break}throw new Error("To Column is missed");case 10:return e.next=12,Promise.all([o.parent.parent.of(f.WebUrl||r)[o.parent.name](f.List||i).item({Query:en()(["".concat(s," IsNotNull"),f.Query]),Scope:"allItems",Limit:1e5}).get({view:["ID",s,m]}),o.of({Query:en()(["".concat(s," IsNotNull"),l.Query]),Scope:"allItems",Limit:1e5}).get({view:["ID",s,g],groupBy:s})]);case 12:return v=e.sent,b=d(v,2),y=b[0],x=b[1],w=[],e.next=19,Promise.all(y.map(function(){var e=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=x[t[s]])){e.next=9;break}if(n=r[0],i={ID:n[an]},!Le(n[g])&&!c){e.next=9;break}return e.next=7,p(m)(t[m]);case 7:i[g]=e.sent,w.push(i);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 19:return e.abrupt("return",w.length&&o.of(w).update(t));case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"erase",value:(s=n(regeneratorRuntime.mark(function e(t){var r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.element,n=r.Query,o=void 0===n?"":n,a=r.Folder,u=r.Columns;if(u){var s=X(u);return i.of({Folder:a,Query:o,Columns:s.reduce(function(e,t){return e[t]=null,e},{})}).updateByQuery(t)}});case 2:return r=e.sent,n=r.result,e.abrupt("return",Et(n,t));case 5:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"createDiscussion",value:(u=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){for(var t=e.clientContext,r=e.element,n=o.getListSPObject(o.listUrl,t),i={Url:!0,ID:!0},a=SP.Utilities.Utility.createNewDiscussion(t,n,r.Title),u=Reflect.ownKeys(r),s=0;s<u.length;s+=1){var c=u[s];i[c]||a.set_item(c,r[c])}return a.update(),a});case 3:return r=e.sent,n=r.clientContexts,i=r.result,e.next=8,Promise.all(n.map(At));case 8:return this.report("create",t),e.abrupt("return",Et(t,i));case 10:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"createReply",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){for(var t=e.clientContext,r=e.element,n=r.Columns,i=o.getSPObject(r,t),a=SP.Utilities.Utility.createNewDiscussionReply(t,i),u=Reflect.ownKeys(n),s=0;s<u.length;s+=1){var c=u[s];a.set_item(c,n[c])}return a.update(),a});case 3:return r=e.sent,n=r.clientContexts,i=r.result,e.next=8,Promise.all(n.map(At));case 8:return this.report("create",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"attachment",value:function(e){return on(this,e)}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};nt(e,c({},t,{name:this.name,box:this.box,listUrl:this.listUrl,contextUrl:this.contextUrl}))}},{key:"cacheColumns",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.contextUrl,r=this.listUrl,ur(["columns",t,r])){e.next=6;break}return e.next=4,this.parent.column().get({view:["TypeAsString","InternalName","Title","Sealed"],mapBy:"InternalName"});case 4:n=e.sent,sr(n)(["columns",t,r]);case 6:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){var r=new SP.CamlQuery,n=e.ID,i=this.getListSPObject(this.listUrl,t),o=t.get_url();switch(j(n)){case"number":return i.getItemById(n);case"string":at(n)?r.set_folderServerRelativeUrl("".concat(o,"/").concat(ht(n))):r.set_viewXml(zr(n));break;default:if(e.set_viewXml)r=e;else{if(e.get_lookupId)return i.getItemById(e.get_lookupId());var a=e.Folder,u=e.Page;if(a){var s="",c="".concat(this.listFolder).concat(this.listUrl,"/").concat(a);if("/"===o)s=c;else s=new RegExp(o,"i").test(a)?a:c;r.set_folderServerRelativeUrl(s)}if(r.set_viewXml(zr(e)),u){var l=u.IsPrevious,f=u.ID,h=u.Columns,p=we(SP.ListItemCollectionPosition);p.set_pagingInfo("".concat(l?"PagedPrev=TRUE&":"","Paged=TRUE&p_ID=").concat(f).concat(function(e){if(!e)return"";for(var t="",r=Reflect.ownKeys(e),n=0;n<r.length;n+=1){var i=r[n],o=e[i],a=o;switch(j(o)){case"object":o.get_lookupValue&&(a=o.get_lookupValue());break;case"date":a=o.toISOString();break;case"boolean":a=o?1:0}"ID"!==o&&void 0!==o&&(t+="&p_".concat(i,"=").concat(encodeURIComponent(a)))}return t}(h))),r.set_listItemCollectionPosition(p)}}}var m=i.getItems(r);return m.camlQuery=r,m}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),t}(),fn=xe(ln),hn=function(e){return null===e?null:e instanceof Date?e.toISOString():e.get_lookupValue?e.get_lookupValue():e.toString?e.toString():e},pn=xe(function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.name="pager",this.parent=t;var n=r.OrderBy;if(this.mainParams={OrderBy:n,Limit:Me(r.Limit)?r.Limit:10,Scope:r.Scope,Query:r.Query,Folder:r.Folder},this.onLoad=r.OnLoad,this.onLoadForward=r.OnLoadForward,this.onLoadBackward=r.OnLoadBackward,this.onLoadAll=r.OnLoadAll,this.onLoadAllForward=r.OnLoadAllForward,this.onLoadAllBackward=r.OnLoadAllBackward,this.onPreload=r.OnPreload,this.onPreloadForward=r.OnPreloadForward,this.onPreloadBackward=r.OnPreloadBackward,this.itemIds={first:0,last:0},this.itemColumns={first:{},lats:{}},this.orderColumnTitles=[],n){var o=Y(/>$/);this.orderColumnTitles=Oe(n)?n.map(o):[o(n)]}}var t;return a(e,[{key:"move",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>0&&void 0!==l[0]?l[0]:{},n=r.view,i=r.groupBy,!(o=r.isPrevious)){e.next=8;break}if(!this.onPreloadBackward){e.next=6;break}return e.next=6,this.onPreloadBackward();case 6:e.next=11;break;case 8:if(!this.onPreloadForward){e.next=11;break}return e.next=11,this.onPreloadForward();case 11:if(!this.onPreload){e.next=14;break}return e.next=14,this.onPreload();case 14:return n&&(n=(t=[]).concat.apply(t,[n].concat(b(this.orderColumnTitles),["ID"]))),i&&(i=void 0),e.next=18,this.parent.item(c({},this.mainParams,{Page:{IsPrevious:o,ID:this.itemIds[o?"first":"last"],Columns:this.itemColumns[o?"first":"last"]}})).get(c({},r,{view:n,groupBy:i}));case 18:if(a=e.sent,!o){e.next=25;break}if(!this.onLoadBackward){e.next=23;break}return e.next=23,this.onLoadBackward();case 23:e.next=28;break;case 25:if(!this.onLoadForward){e.next=28;break}return e.next=28,this.onLoadForward();case 28:if(!this.onLoad){e.next=31;break}return e.next=31,this.onLoad();case 31:if(!a.length){e.next=57;break}if(u=ae(a),s=se(a),!o){e.next=52;break}if(this.itemIds.first!==u.ID){e.next=47;break}if(a=[],this.itemIds.last=0,this.lastItemColumns={},!this.onLoadAll){e.next=42;break}return e.next=42,this.onLoadAll();case 42:if(!this.onLoadAllBackward){e.next=45;break}return e.next=45,this.onLoadAllBackward();case 45:e.next=50;break;case 47:this.itemIds.first=u.ID,this.itemIds.last=s.ID,this.orderColumnTitles.length&&(this.itemColumns=this.orderColumnTitles.reduce(function(e,t){return e.first[t]=hn(u[t]),e.last[t]=hn(s[t]),e},{first:{},last:{}}));case 50:e.next=55;break;case 52:this.itemIds.first=u.ID,this.itemIds.last=s.ID,this.orderColumnTitles.length&&(this.itemColumns=this.orderColumnTitles.reduce(function(e,t){return e.first[t]=hn(u[t]),e.last[t]=hn(s[t]),e},{first:{},last:{}}));case 55:e.next=69;break;case 57:if(!o){e.next=63;break}if(!this.onLoadAllBackward){e.next=61;break}return e.next=61,this.onLoadAllBackward();case 61:e.next=66;break;case 63:if(!this.onLoadAllForward){e.next=66;break}return e.next=66,this.onLoadAllForward();case 66:if(!this.onLoadAll){e.next=69;break}return e.next=69,this.onLoadAll();case 69:return e.abrupt("return",a);case 70:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"next",value:function(e){return this.move(e)}},{key:"previous",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.move(c({},e,{isPrevious:!0}))}}]),e}()),mn="Title",gn=Re([he(mn),pe(mn)]),dn=H({object:function(e){var t=Object.assign({},e),r=e.Url,n=e.EntityTypeName,i=e.Title;return t[mn]=n||r||i,G(/\//)(r)&&("/"!==r&&(t[mn]=ht(dt(r))),t.Url=at(r)?"/":pt(r)||"/"),t},string:function(e){var t={Url:void 0,Title:e};return G(/\//)(e)&&(t.Title=dt(e),t.Url=at(e)?"/":pt(e)||"/"),t},default:function(){return u({Url:"/"},mn,void 0)}}),vn=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,dn,gn))).prop=mn,r.joinProp=mn,r}return l(t,Rt),t}(),bn=function(){function e(t,r){i(this,e),this.name="list",this.prop=mn,this.joinProp=mn,this.parent=t,this.contextUrl=t.box.getHeadPropValue(),this.box=xe(vn)(r),this.count=t.box.getCount(),this.iterator=St({contextUrl:this.contextUrl,elementBox:this.box})}var t,r,o,u,s,l,f,h,p,m,g;return a(e,[{key:"get",value:(g=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element,i=at(n.Url)?o.getSPObjectCollection(r):o.getSPObject(n.Title,r);return Lt(r,i,t)});case 2:return r=e.sent,n=r.clientContexts,i=r.result,e.next=7,Promise.all(n.map(At));case 7:return e.abrupt("return",Et(i,t));case 8:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"create",value:(m=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element,i=n[mn];if(i){var o=Re([we,$t({set_title:i||void 0,set_templateType:n.BaseTemplate||SP.ListTemplateType[n.TemplateType||"genericList"],set_url:"/"===n.Url?i:n.Url,set_templateFeatureId:n.TemplateFeatureId,set_customSchemaXml:n.CustomSchemaXml,set_dataSourceProperties:n.DataSourceProperties,set_documentTemplateType:n.DocumentTemplateType,set_quickLaunchOption:n.QuickLaunchOption}),de("add")(a.getSPObjectCollection(r)),N($t({set_contentTypesEnabled:n.ContentTypesEnabled,set_defaultContentApprovalWorkflowId:n.DefaultContentApprovalWorkflowId,set_defaultDisplayFormUrl:n.DefaultDisplayFormUrl,set_defaultEditFormUrl:n.DefaultEditFormUrl,set_defaultNewFormUrl:n.DefaultNewFormUrl,set_description:n.Description,set_direction:n.Direction,set_draftVersionVisibility:n.DraftVersionVisibility,set_enableAttachments:n.EnableAttachments||!1,set_enableFolderCreation:void 0===n.EnableFolderCreation||n.EnableFolderCreation,set_enableMinorVersions:n.EnableMinorVersions,set_enableModeration:n.EnableModeration,set_enableVersioning:void 0===n.EnableVersioning||n.EnableVersioning,set_forceCheckout:n.ForceCheckout,set_hidden:n.Hidden,set_imageUrl:n.ImageUrl,set_irmEnabled:n.IrmEnabled,set_irmExpire:n.IrmExpire,set_irmReject:n.IrmReject,set_isApplicationList:n.IsApplicationList,set_lastItemModifiedDate:n.LastItemModifiedDate,set_majorVersionLimit:n.EnableVersioning?n.MajorVersionLimit:void 0,set_multipleDataList:n.MultipleDataList,set_noCrawl:void 0===n.NoCrawl||n.NoCrawl,set_objectVersion:n.ObjectVersion,set_onQuickLaunch:n.OnQuickLaunch,set_validationFormula:n.ValidationFormula,set_validationMessage:n.ValidationMessage})),N(V(F(!n.BaseTemplate&&!E[n.TemplateType]))([$t({set_documentTemplateUrl:n.DocumentTemplateUrl,MajorWithMinorVersionsLimit:n.EnableVersioning?n.MajorWithMinorVersionsLimit:void 0})])),N(me("update"))])(SP.ListCreationInformation);return Lt(r,o,t)}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=13;break}o=0;case 7:if(!(o<n.length)){e.next=13;break}return e.next=10,At(n[o]);case 10:o+=1,e.next=7;break;case 13:return this.report("create",t),e.abrupt("return",Et(i,t));case 15:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"update",value:(p=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element,i=n[mn];if(i){var a=Re([$t({set_title:i,set_enableFolderCreation:n.EnableFolderCreation,set_contentTypesEnabled:n.ContentTypesEnabled,set_defaultContentApprovalWorkflowId:n.DefaultContentApprovalWorkflowId,set_defaultDisplayFormUrl:n.DefaultDisplayFormUrl,set_defaultEditFormUrl:n.DefaultEditFormUrl,set_defaultNewFormUrl:n.DefaultNewFormUrl,set_description:n.Description,set_direction:n.Direction,set_draftVersionVisibility:n.DraftVersionVisibility,set_documentTemplateUrl:n.DocumentTemplateUrl,set_enableAttachments:n.EnableAttachments,set_enableMinorVersions:n.EnableMinorVersions,set_enableModeration:n.EnableModeration,set_enableVersioning:n.EnableVersioning,set_forceCheckout:n.ForceCheckout,set_hidden:n.Hidden,set_imageUrl:n.ImageUrl,set_irmEnabled:n.IrmEnabled,set_irmExpire:n.IrmExpire,set_irmReject:n.IrmReject,set_isApplicationList:n.IsApplicationList,set_lastItemModifiedDate:n.LastItemModifiedDate,set_majorVersionLimit:n.MajorVersionLimit,set_majorWithMinorVersionsLimit:n.MajorWithMinorVersionsLimit,set_multipleDataList:n.MultipleDataList,set_noCrawl:n.NoCrawl,set_objectVersion:n.ObjectVersion,set_onQuickLaunch:n.OnQuickLaunch,set_validationFormula:n.ValidationFormula,set_validationMessage:n.ValidationMessage}),N(me("update"))])(o.getSPObject(i,r));return Lt(r,a,t)}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("update",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"delete",value:(h=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.noRecycle,e.next=4,this.iterator(function(e){var t=e.clientContext,n=e.element[mn];if(n){var i=a.getSPObject(n,t);return me(r?"deleteObject":"recycle")(i),n}});case 4:if(n=e.sent,i=n.clientContexts,o=n.result,!this.count){e.next=10;break}return e.next=10,Promise.all(i.map(At));case 10:return this.report(r?"delete":"recycle",t),e.abrupt("return",Et(o,t));case 12:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"cloneLayout",value:(f=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("cloning layout in progress..."),e.next=3,this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(r){var i,o,a,u,s,c,l,f,h,p,m,g,v,b,y,x,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.element,u=i.Title,s=i.Url,c=i.To,Ce(c)?(a=t.contextUrl,o=c):(a=c.WebUrl||t.contextUrl,o=c.ListUrl),l=s||u,o){e.next=6;break}throw new Error("Target listUrl is missed");case 6:if(l){e.next=8;break}throw new Error("Source list Title is missed");case 8:return f=dt(o),h=t.parent.of(a),p=t.parent.of(t.contextUrl),m=h.list(o),g=p.list(l),e.next=15,m.get({silent:!0}).catch(n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Object,e.t1={},e.next=4,g.get();case 4:return e.t2=e.sent,(t=e.t0.assign.call(e.t0,e.t1,e.t2)).Title=f,t.Url=f,t.EntityTypeName=f,e.next=11,h.list(t).create();case 11:case"end":return e.stop()}},e)})));case 15:return e.next=17,Promise.all([g.column().get(),m.column().get({groupBy:"InternalName"})]);case 17:return v=e.sent,b=d(v,2),y=b[0],x=b[1],w=y.reduce(function(e,t){return x[t.InternalName]||t.FromBaseType||e.push(Object.assign({},t)),e},[]),e.abrupt("return",w.length?m.column(w).create():void 0);case 23:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:console.log("cloning layout done!");case 4:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"clone",value:(l=n(regeneratorRuntime.mark(function e(t){var r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={Attachments:!0,MetaInfo:!0,FileLeafRef:!0,FileDirRef:!0,FileRef:!0,Order:!0},console.log("cloning in progress..."),e.next=4,this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(n){var o,a,u,s,c,l,f,h,p,m,g,v,b,y,x,w,k,_,R,S,U,P;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.contextElement,a=n.element,u=o.Url,l=a.Title,f=a.To,h=a.Url,Ce(f)?(s=u,c=f):(s=f.WebUrl,c=f.ListUrl),p=l||h,s){e.next=7;break}throw new Error("Target webUrl is missed");case 7:if(c){e.next=9;break}throw new Error("Target listUrl is missed");case 9:if(p){e.next=11;break}throw new Error("Source list Title is missed");case 11:return m=f.Title||dt(c),g=i.web(s),v=i.web(u),b=g.list(m),y=v.list(p),e.next=18,v.list(a).cloneLayout();case 18:return console.log("cloning items..."),e.next=21,Promise.all([y.get(),y.column().get({groupBy:"InternalName",view:["ReadOnlyField","InternalName"]}),y.item({Query:"",Scope:"allItems"}).get()]);case 21:if(x=e.sent,w=d(x,3),k=w[0],_=w[1],R=w[2],!k.BaseType){e.next=37;break}S=0;case 28:if(!(S<R.length)){e.next=35;break}return U=R[S],e.next=32,v.library(p).file({Url:kt(u)(p)({Url:U.FileRef}),To:{WebUrl:s,ListUrl:c}}).copy(t);case 32:S+=1,e.next=28;break;case 35:e.next=39;break;case 37:return P=R.map(function(e){var t={},n=kt(u)(p)({Url:e.FileDirRef});n&&(t.Folder=n);for(var i=Reflect.ownKeys(e),o=0;o<i.length;o+=1){var a=i[o],s=e[a],c=_[a];c&&(c[0].ReadOnlyField||r[a]||!$e(s)||(t[a]=s))}return t}),e.abrupt("return",b.item(P).create());case 39:return e.abrupt("return",void 0);case 40:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:console.log("cloning is complete!");case 5:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"clear",value:(s=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("clearing in progress..."),e.next=3,this.item({Query:""}).deleteByQuery(t);case 3:console.log("clearing is complete!");case 4:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"getAggregations",value:(u=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.iterator(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,i,o,a,u,s,c,l,f,h,p,m,g,d,v,b,y,x,w,k,_,R,S;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=r.contextElement,i=r.element,o=n.Url,a="",u="",s="",c={},l=i.Title,f=i.Columns,h=i.Scope,p=void 0===h?"all":h,m=i.Query,g=Tt(o),d=t.getSPObject(l,g),v=Reflect.ownKeys(f),b=0;b<v.length;b+=1)y=v[b],u+='<FieldRef Name="'.concat(y,'" Type="').concat(f[y],'"/>'),c[y]=0;return p&&(a=Jr()),m&&(s="<Query><Where>".concat(Yr(m),"</Where></Query>")),x=d.renderListData("<View".concat(a,">").concat(s,"<Aggregations>").concat(u,"</Aggregations></View>")),e.next=16,At(g);case 16:for(w=JSON.parse(x.get_value()).Row[0],k=Reflect.ownKeys(w),_=0;_<k.length;_+=1)R=k[_],S=R.split(".")[0],Reflect.hasOwnProperty.call(f,S)&&(c[S]=Number(w[R]));return e.abrupt("return",c);case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"getPermissions",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var t=e.clientContext,r=e.element,n=o.getSPObject(r[mn],t);return Lt(t,n,{view:"EffectiveBasePermissions"})});case 2:return t=e.sent,r=t.clientContexts,n=t.result,e.next=7,Promise.all(r.map(At));case 7:return i=Yt(),e.abrupt("return",Object.keys(i).reduce(function(e,t){return e[t]=n.get_effectiveBasePermissions().has(i[t]),e},{}));case 9:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"breakRoleInheritance",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var t=e.clientContext,r=e.element[mn];if(r){var n=i.getSPObject(r,t);return me("breakRoleInheritance")(n),r}});case 2:if(t=e.sent,r=t.clientContexts,n=t.result,!this.count){e.next=8;break}return e.next=8,Promise.all(r.map(At));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"resetRoleInheritance",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var t=e.clientContext,r=e.element[mn];if(r){var n=i.getSPObject(r,t);return me("resetRoleInheritance")(n),r}});case 2:if(t=e.sent,r=t.clientContexts,n=t.result,!this.count){e.next=8;break}return e.next=8,Promise.all(r.map(At));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"column",value:function(e){return nr(this,e)}},{key:"folder",value:function(e){return dr(this,e)}},{key:"item",value:function(e){return fn(this,e)}},{key:"pager",value:function(e){return pn(this,e)}},{key:"getSPObject",value:function(e,t){return this.getSPObjectCollection(t)[je(e)?"getById":"getByTitle"](e)}},{key:"getSPObjectCollection",value:function(e){return this.parent.getSPObject(e).get_lists()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};rt(e,c({},t,{name:this.name,box:this.box,contextUrl:this.contextUrl}))}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),yn=function(e){function t(e,r){var n;return i(this,t),(n=g(this,f(t).call(this,e,r))).name="library",n}return l(t,bn),a(t,[{key:"file",value:function(e){return Ir(this,e)}}]),t}(),xn=function(e,t,r){return xe("library"===r?yn:bn)(e,t)},wn=function(e){return function(t){var r;if(Ee(t)){var n=t.Folder,i=t.Columns;r=n||(void 0===i?{}:i).Folder}else Ce(t)&&(r=t);var o=Re([ht,pt,gt])(r);return kn(e)()(o),e}},kn=M(function(e){return function(t){return function(r){return function(n){var i=v(n),o=i[0],a=i.slice(1),u=t,s=r?"".concat(r,"/").concat(o):o;if(a.length)return u[s]||(u[s]={}),e(u[s])(s)(a);u[s]||(u[s]={})}}}}),_n=function(e){var t={};return Oe(e)?e.map(wn(t)):wn(t)(e),t},Rn=Re([st,lt]),Sn=H({object:function(e){var t=Object.assign({},e);return Fe(e.Url)&&(t.Url=e.ServerRelativeUrl),"/"!==e.Url&&(t.Url=pt(t.Url)),!e.ServerRelativeUrl&&e.Url&&(t.ServerRelativeUrl=e.Url),t},string:function(e){var t,r="/"===e?"/":pt(mt(e));return u(t={},"Url",r),u(t,"ServerRelativeUrl",r),t},default:function(){var e;return u(e={},"Url",""),u(e,"ServerRelativeUrl",""),e}}),Un=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,Sn,Rn))).joinProp="ServerRelativeUrl",r}return l(t,Rt),t}(),Pn=function(){function e(t,r){i(this,e),this.name="folder",this.parent=t,this.box=xe(Un)(r),this.contextUrl=t.box.getHeadPropValue(),this.count=this.box.getCount(),this.iterator=St({contextUrl:this.contextUrl,elementBox:this.box})}var t,r,o,s;return a(e,[{key:"get",value:(s=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.contextUrl,e.next=3,this.iterator(function(e){var n=e.clientContext,i=e.element,o=_t(r)(i),u=at(o)?a.getSPObjectCollection(o,n):a.getSPObject(o,n);return Lt(n,u,t)});case 3:return n=e.sent,i=n.clientContexts,o=n.result,e.next=8,Promise.all(i.map(At));case 8:return e.abrupt("return",Et(o,t));case 9:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"create",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,i,o,a,s,l=this,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},r=this.contextUrl,i=_t(r),o=this.box.prop,a=this.box.reduce(function(e){return function(t){return e[t[o]]=t,e}},{}),s=[],e.next=8,M(function(e){return o=n(regeneratorRuntime.mark(function o(c){var f,h,p,m,g,d,v,b,y;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:for(f=Reflect.ownKeys(c),h=[],p=0;p<f.length;p+=1)m=f[p],g=a[m],d=Tt(r),v=void 0,v=g?i(g):m,b=bt(v),y=l.getSPObjectCollection("".concat(b,"/"),d).add(dt(v)),Lt(d,y,t),h.push(Ft(d,y,t).catch(A));return o.t0=Et,o.next=6,Promise.all(h);case 6:return o.t1=function(e){return"error"!==j(e)},o.t2=o.sent.filter(o.t1),o.t3=t,(0,o.t0)(o.t2,o.t3).reduce(function(e,t){return a[i(u({},"Url",t.ServerRelativeUrl))]&&e.push(t),e},s),o.next=13,Promise.all(f.map(function(){var t=n(regeneratorRuntime.mark(function t(r){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=c[r],!We(n)){t.next=4;break}return t.next=4,e(n);case 4:return t.abrupt("return",void 0);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()));case 13:return o.abrupt("return",void 0);case 14:case"end":return o.stop()}},o)})),function(e){return o.apply(this,arguments)};var o})(_n(this.box.getIterable().map(be(o))));case 8:return rt("create",c({},t,{name:this.name,box:xe(Un)(s),contextUrl:this.contextUrl})),e.abrupt("return",this.box.isArray()?s:s[0]);case 10:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"update",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=this.contextUrl,e.next=4,this.iterator(function(e){var n=e.clientContext,i=e.element,o=_t(r)(i),u=i.WelcomePage,s=a.getSPObject(o,n);return Me(u)&&(s.set_welcomePage(u),s.update()),Lt(n,s,t)});case 4:if(n=e.sent,i=n.clientContexts,o=n.result,!this.count){e.next=10;break}return e.next=10,Promise.all(i.map(At));case 10:return this.report("update",t),e.abrupt("return",Et(o,t));case 12:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"delete",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u=this,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=t.noRecycle,n=this.contextUrl,e.next=5,this.iterator(function(e){var t=e.clientContext,i=e.element,o=_t(n)(i);if(wt(o)){var a=u.getSPObject(o,t);return a.isRoot||me(r?"deleteObject":"recycle")(a),o}});case 5:if(i=e.sent,o=i.clientContexts,a=i.result,!this.box.getCount()){e.next=11;break}return e.next=11,Promise.all(o.map(At));case 11:return this.report(r?"delete":"recycle",t),e.abrupt("return",Et(a,t));case 13:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){var r,n=this.parent.getSPObject(t);if(e)r=n.getFolderByServerRelativeUrl(e);else{var i=n.get_rootFolder();i.isRoot=!0,r=i}return r}},{key:"getSPObjectCollection",value:function(e,t){return e&&"/"!==e?this.getSPObject(ht(e),t).get_folders():this.getSPObject(void 0,t).get_folders()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};rt(e,c({},t,{name:this.name,box:this.box,contextUrl:this.contextUrl}))}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),Tn=xe(Pn),Cn=Re([st,lt]),On=H({object:function(e){var t=Object.assign({},e);return"/"!==e.Url&&(t.Url=pt(t.Url)),!e.Url&&e.ServerRelativeUrl&&(t.Url=e.ServerRelativeUrl),!e.ServerRelativeUrl&&e.Url&&(t.ServerRelativeUrl=e.Url),t},string:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r="/"===t?"/":pt(mt(t));return u(e={},"Url",r),u(e,"ServerRelativeUrl",r),e},default:function(){var e;return u(e={},"Url",""),u(e,"ServerRelativeUrl",""),e}}),En=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,On,Cn))).joinProp="ServerRelativeUrl",r}return l(t,Rt),a(t,[{key:"getCount",value:function(){return this.isArray()?ct(this.value).length:ut(this.value[this.prop])?1:0}}]),t}(),In=function(){function e(t,r){i(this,e),this.name="file",this.parent=t,this.box=xe(En)(r),this.contextUrl=t.box.getHeadPropValue(),this.iterator=St({contextUrl:this.contextUrl,elementBox:this.box}),this.iteratorREST=Ut({elementBox:this.box})}var t,r,o,s,l,f;return a(e,[{key:"get",value:(f=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u,s,l,f,h=this,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]?p[0]:{},r=t.asBlob,n=t.asString,i=t.asItem,!r&&!n){e.next=8;break}return o=this.contextUrl,e.next=6,this.iteratorREST(function(e){var t=e.element,r=_t(o)(t);return Mt(o,{url:"".concat(h.getRESTObject(r,o),"/$value"),binaryStringResponseBody:!n})});case 6:return a=e.sent,e.abrupt("return",n?a.body:It(a,t));case 8:return u=i?c({},t,{view:["ListItemAllFields"]}):c({},t),e.next=11,this.iterator(function(e){var t=e.clientContext,r=e.element,n=_t(h.contextUrl)(r),i=Ve(n)||at(n)?h.getSPObjectCollection(n,t):h.getSPObject(n,t);return Lt(t,i,u)});case 11:return s=e.sent,l=s.clientContexts,f=s.result,e.next=16,Promise.all(l.map(At));case 16:return e.abrupt("return",Et(f,u));case 17:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"create",value:(l=n(regeneratorRuntime.mark(function e(){var t,r,i,o,a,u,s=this,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:{},!(r=this.box.reduce(function(e){return function(t){var r=t.Folder,n=bt(_t(s.contextUrl)(t))||r;return n&&e.push(n),e}})).length){e.next=5;break}return e.next=5,this.parent.folder(r).get({view:"ServerRelativeUrl"}).catch(n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.parent.folder(r).create({silent:!0});case 2:case"end":return e.stop()}},e)})));case 5:return e.next=7,this.iterator(function(e){var r=e.clientContext,n=e.element,i=_t(s.contextUrl)(n);if(ut(i)){var o=n.Content,a=void 0===o?"":o,u=n.Overwrite,l=void 0===u||u,f=t.asItem?c({},t,{view:["ListItemAllFields"]}):c({},t),h=s.getSPObjectCollection(bt(i),r),p=new SP.FileCreationInformation;$t({set_url:xt(i),set_content:Dt(a),set_overwrite:l})(p);var m=h.add(p);return Lt(r,m,f)}});case 7:if(i=e.sent,o=i.clientContexts,a=i.result,!this.box.getCount()){e.next=18;break}u=0;case 12:if(!(u<o.length)){e.next=18;break}return e.next=15,At(o[u]);case 15:u+=1,e.next=12;break;case 18:return this.report("create",t),e.abrupt("return",Et(a,t));case 20:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"update",value:(s=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var t=e.clientContext,r=e.element,n=r.Content,i=_t(u.contextUrl)(r);if(ut(i)){var o=new SP.FileSaveBinaryInformation;void 0!==n&&o.set_content(Dt(n));var a=u.getSPObject(i,t);return a.saveBinary(o),a}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.box.getCount()){e.next=14;break}o=0;case 7:if(!(o<n.length)){e.next=14;break}return a=n[o],e.next=11,At(a);case 11:o+=1,e.next=7;break;case 14:return this.report("update",t),e.abrupt("return",Et(i,t));case 16:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"delete",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.noRecycle,e.next=4,this.iterator(function(e){var t=e.clientContext,n=e.element,i=_t(a.contextUrl)(n);if(ut(i)){var o=a.getSPObject(i,t);return me(r?"deleteObject":"recycle")(o),i}});case 4:if(n=e.sent,i=n.clientContexts,o=n.result,!this.box.getCount()){e.next=10;break}return e.next=10,Promise.all(i.map(At));case 10:return this.report(r?"delete":"recycle",t),e.abrupt("return",Et(o,t));case 12:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"copy",value:(r=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.contextUrl,e.next=3,this.iterator(function(e){var t,n=e.clientContext,i=e.element,o=_t(r)(i);if(ut(o))return a.getSPObject(o,n).copyTo(_t(r)((u(t={},"Url",i.To),u(t,"Folder",i.Folder),t))),o});case 3:if(n=e.sent,i=n.clientContexts,o=n.result,!this.box.getCount()){e.next=9;break}return e.next=9,Promise.all(i.map(At));case 9:return this.report("copy",t),e.abrupt("return",Et(o,t));case 11:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"move",value:(t=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.contextUrl,e.next=3,this.iterator(function(e){var t,n=e.clientContext,i=e.element,o=_t(r)(i);if(ut(o))return a.getSPObject(o,n).moveTo(_t(r)((u(t={},"Url",i.To),u(t,"Folder",i.Folder),t))),o});case 3:if(n=e.sent,i=n.clientContexts,o=n.result,!this.box.getCount()){e.next=9;break}return e.next=9,Promise.all(i.map(At));case 9:return this.report("move",t),e.abrupt("return",Et(o,t));case 11:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){var r=this.contextUrl,n=yt(e),i=xt(e);return this.parent.getSPObject(t).getFileByServerRelativeUrl(mt("/".concat(n?"".concat(r,"/").concat(n):r,"/").concat(i)))}},{key:"getSPObjectCollection",value:function(e,t){var r=this.contextUrl,n=yt(e),i=this.parent.getSPObject(t);return n?i.getFolderByServerRelativeUrl("/".concat(r,"/").concat(n)).get_files():i.get_rootFolder().get_files()}},{key:"getRESTObject",value:function(e,t){var r=xt(e),n=yt(e);return mt("/_api/web/getfilebyserverrelativeurl('".concat(ft(n?"".concat(t,"/").concat(n):t),"/").concat(r,"')"))}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};rt(e,c({},t,{name:this.name,box:this.box,contextUrl:this.contextUrl}))}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),jn=xe(In),Ln=xe(function(){function e(t){i(this,e),this.name="recycleBin",this.parent=t,this.contextUrl=t.box.getHeadPropValue()}var t,r,o;return a(e,[{key:"get",value:(o=n(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(this.contextUrl),e.next=3,Ft(r,this.getSPObjectCollection(r),t);case 3:return n=e.sent,e.abrupt("return",Et(n,t));case 5:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"restoreAll",value:(r=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(this.contextUrl),(n=this.getSPObjectCollection(r)).restoreAll(),e.next=5,Ft(r,n,t);case 5:return i=e.sent,this.report("restore",t),e.abrupt("return",Et(i,t));case 8:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"deleteAll",value:(t=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(this.contextUrl),(n=this.getSPObjectCollection(r)).deleteAll(),e.next=5,Ft(r,n,t);case 5:return i=e.sent,this.report("delete",t),e.abrupt("return",Et(i,t));case 8:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};et("".concat(O[e]," ").concat(this.name," at ").concat(this.contextUrl),t)}},{key:"getSPObjectCollection",value:function(e){return this.parent[this.contextUrl?"getSPObject":"getSiteSPObject"](e).get_recycleBin()}}]),e}()),An="Title",Fn="Login",Mn="Email",Bn=function(){function e(t,r,n){i(this,e),this.name="user",this.parent=t,this.isArray=Oe(r),this.users=r?this.isArray?oe(r):[r]:[],this.isSP=n,this.isNative=this.isSP||!Pr||!Tr,Ur||(Ur=t.of().list("User Information List"))}var t,r,o,u,s,l,f,h,p;return a(e,[{key:"get",value:(p=n(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.users.length){e.next=5;break}if(r=this.users[0],!Ee(r)){e.next=4;break}return e.abrupt("return",Je(Tr)(r)?this.getByUid(t):Je(Fn)(r)?this.getByName(t):Je(Mn)(r)?this.getByEMail(t):Je(Fn)(r)?this.getByLogin(t):void 0);case 4:return e.abrupt("return","/"===r?this.getAll(t):De(r)?this.getByUid(t):/[--\s]/.test(r)?this.getByName(t):/\S+@\S+\.\S+/.test(r)?this.getByEMail(t):this.getByLogin(t));case 5:return e.abrupt("return",this.getCurrent(t));case 6:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"getCurrent",value:(h=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},!this.isSP&&Pr){e.next=10;break}return r=Tt("/"),n=r.get_web().get_currentUser(),e.t0=Et,e.next=7,Ft(r,n,t);case 7:return e.t1=e.sent,e.t2=t,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 10:if(!window._spPageContextInfo){e.next=14;break}e.t3=window._spPageContextInfo.userId,e.next=17;break;case 14:return e.next=16,this.of(null,!0).getCurrent({view:"Id"});case 16:e.t3=e.sent.Id;case 17:return i=e.t3,e.next=20,Pr.item("Number ".concat(Tr," Eq ").concat(i)).get(t);case 20:return e.abrupt("return",e.sent[0]);case 21:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"getByUid",value:(f=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=ie(function(e){return function(t){switch(t.constructor.getName()){case"String":case"Number":e.push(t);break;case"Object":var r=t[a.isNative?"ID":Tr];r&&e.push(r);break;case"SP.FieldUserValue":e.push(t.get_lookupId());break;case"SP.ListItem":var n=t.get_item(a.isNative?"ID":Tr);n&&e.push(n)}return e}})([])(this.users),n="Number ".concat(Tr," In ").concat(r),i=this.isNative?Ur.item(r):Pr.item(Cr?en("and")([Cr,n]):n),e.next=6,i.get(t);case 6:return o=e.sent,e.abrupt("return",this.isArray||o.length>1?o:o[0]);case 8:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"getByLogin",value:(l=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u=this,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=!1,n=ie(function(e){return function(t){switch(t.constructor.getName()){case"String":/\|/.test(t)&&(r=!0),e.push(t);break;case"Object":var n=t.UserName;n||(r=!0),e.push(u.isNative?n||t.Name:t.customLoginColumn);break;case"SP.ListItem":var i=t.get_item("UserName");i||(r=!0),e.push(u.isNative?i||t.get_item("Name"):t.get_item(Fn))}return e}})([])(this.users),i="".concat(Fn," In ").concat(n),o=this.isNative?Ur.item("".concat(r?"Name":"UserName"," In ").concat(n)):Pr.item(Cr?en("and")([Cr,i]):i),e.next=7,o.get(t);case 7:return a=e.sent,e.abrupt("return",this.isArray||a.length>1?a:a[0]);case 9:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"getByName",value:(s=n(regeneratorRuntime.mark(function e(){var t,r,n,i=this,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=ie(function(e){return function(t){switch(t.constructor.getName()){case"String":e.push(t);break;case"Object":var r=t[i.isNative?"Title":An];r&&e.push(r);break;case"SP.ListItem":var n=t.get_item(i.isNative?"Title":An);n&&e.push(n)}return e}})([])(this.users),n="".concat(An," Contains ").concat(r),e.abrupt("return",this.isNative?Ur.item("Title Contains ".concat(r)).get(t):Pr.item(Cr?en("and")([Cr,n]):n).get(t));case 4:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"getByEMail",value:(u=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=ie(function(e){return function(t){switch(t.constructor.getName()){case"String":e.push(t);break;case"Object":var r=t[a.isNative?"EMail":Mn];r&&e.push(r);break;case"SP.ListItem":var n=t.get_item(a.isNative?"EMail":Mn);n&&e.push(n)}return e}})([])(this.users),n="".concat(Mn," In ").concat(r),i=this.isNative?Ur.item("EMail In ".concat(r)):Pr.item(Cr?en("and")([Cr,n]):n),e.next=6,i.get(t);case 6:return o=e.sent,e.abrupt("return",this.isArray||o.length>1?o:o[0]);case 8:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"getAll",value:(o=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isNative?Ur.item().get(t):Pr.item(Cr).get(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"create",value:(r=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Pr){e.next=2;break}throw new Error("Custom user list is missed");case 2:if(!this.users.filter(function(e){return e[Tr]&&e[An]}).length){e.next=5;break}return e.abrupt("return",Pr.item(this.users).create(t));case 5:throw new Error("missing user id or Title");case 6:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"update",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},!this.isSP){e.next=6;break}return e.next=4,Ur.item(this.users).update(t);case 4:return r=e.sent,e.abrupt("return",this.isArray||r.length>1?r:r[0]);case 6:if(Pr){e.next=8;break}throw new Error("Custom user list is missed");case 8:if(!(n=this.users.filter(function(e){return!!e[Tr]})).length){e.next=18;break}return e.next=12,this.of(n).get({view:["ID",Tr],mapBy:Tr});case 12:return i=e.sent,o=this.users.reduce(function(e,t){var r=i[t[Tr]]?i[t[Tr]].ID:void 0;if(r){t[Tr];var n=m(t,[Tr].map(k));n.ID=r,e.push(n)}return e},[]),e.next=16,Pr.item(o).update(c({},t,{view:["ID",Tr]}));case 16:return a=e.sent,e.abrupt("return",this.isArray||a.length>1?a:a[0]);case 18:throw new Error("missing user id");case 19:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"setDefaults",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.customWebTitle&&e.customListTitle&&(Pr=this.parent.of(e.customWebTitle).list(e.customListTitle)),e.defaultListTitle&&(Ur=this.parent.of().list(e.defaultListTitle)),e.customIdColumn&&(Tr=e.customIdColumn),e.customLoginColumn&&(Fn=e.customLoginColumn),e.customNameColumn&&(An=e.customNameColumn),e.customEmailColumn&&(Mn=e.customEmailColumn),e.customQuery&&(Cr=e.customQuery)}},{key:"of",value:function(e,t){return xe(this.constructor)(this.parent,e,t)}}]),e}(),Nn=xe(Bn),Dn="Title",Vn=Re([he(Dn),pe(Dn)]),Qn=H({object:function(e){var t=Object.assign({},e),r=e.Title,n=e.LoginName;return t[Dn]=n||r,t.LoginName||(t.LoginName=t[Dn]),t},string:function(e){var t;return u(t={},Dn,e),u(t,"LoginName",e),t},number:function(e){var t;return u(t={},Dn,e),u(t,"LoginName",e),t},default:function(){var e;return u(e={},Dn,void 0),u(e,"LoginName",void 0),e}}),Hn=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,Qn,Vn))).prop=Dn,r.joinProp=Dn,r}return l(t,Rt),t}(),qn=function(){function e(t,r){i(this,e),this.name="user",this.parent=t,this.box=xe(Hn)(r),this.groupName=this.parent.box.getHead()[Dn],this.count=this.box.getCount(),this.iterator=St({elementBox:this.box})}var t,r,o;return a(e,[{key:"get",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var r=e.clientContext,n=e.element.Title,i=n?o.getSPObject(n,r):o.getSPObjectCollection(r);return Lt(r,i,t)});case 3:return r=e.sent,n=r.clientContexts,i=r.result,e.next=8,Promise.all(n.map(At));case 8:return e.abrupt("return",Et(i,t));case 9:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"create",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var r=e.clientContext,n=e.element,i=o.getSPObjectCollection(r),a=we(SP.UserCreationInformation);$t({set_email:n.Email,set_loginName:n.LoginName,set_title:n[Dn]})(a);var u=i.add(a);return Lt(r,u,t)});case 3:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=9;break}return e.next=9,Promise.all(n.map(At));case 9:return this.report("create",t),e.abrupt("return",Et(i,t));case 11:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"delete",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var t=e.clientContext,r=e.element[Dn];return o.getSPObjectCollection(t)[Te(r)?"removeById":"removeByLoginName"](r),r});case 3:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=9;break}return e.next=9,Promise.all(n.map(At));case 9:return this.report("delete",t),e.abrupt("return",Et(i,t));case 11:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getSPObject",value:function(e,t){return this.getSPObjectCollection(t)[Te(e)?"getById":/@.+\./.test(e)?"getByEmail":"getByLoginName"](e)}},{key:"getSPObjectCollection",value:function(e){return this.parent.getSPObject(this.groupName,e).get_users()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};nt(e,c({},t,{name:this.name,box:this.box,contextUrl:"/",listUrl:this.groupName}))}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),Wn=xe(qn),Gn="Title",$n=Re([he(Gn),pe(Gn)]),Kn=H({object:function(e){var t=Object.assign({},e),r=e.Title,n=e.LoginName;return t[Gn]=n||r,t.LoginName||(t.LoginName=t[Gn]),t},string:function(e){var t;return u(t={},Gn,e),u(t,"LoginName",e),t},number:function(e){var t;return u(t={},Gn,e),u(t,"LoginName",e),t},default:function(){var e;return u(e={},Gn,void 0),u(e,"LoginName",void 0),e}}),Yn=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,Kn,$n))).prop=Gn,r.joinProp=Gn,r}return l(t,Rt),t}(),Jn=function(){function e(t,r){i(this,e),this.name="group",this.parent=t,this.box=xe(Yn)(r),this.count=this.box.getCount(),this.iterator=St({elementBox:this.box})}var t,r,o,u;return a(e,[{key:"get",value:(u=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var r=e.clientContext,n=e.element.Title,i=n?o.getSPObject(n,r):o.getSPObjectCollection(r);return Lt(r,i,t)});case 3:return r=e.sent,n=r.clientContexts,i=r.result,e.next=8,Promise.all(n.map(At));case 8:return e.abrupt("return",Et(i,t));case 9:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"create",value:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var r=e.clientContext,n=e.element,i=o.getSPObjectCollection(r),a=we(SP.GroupCreationInformation);$t({set_description:n.Description,set_title:n[Gn]})(a);var u=i.add(a);return $t({set_allowMembersEditMembership:n.AllowMembersEditMembership,set_allowRequestToJoinLeave:n.AllowRequestToJoinLeave,set_autoAcceptRequestToJoinLeave:n.AutoAcceptRequestToJoinLeave,set_onlyAllowMembersViewMembership:n.OnlyAllowMembersViewMembership,set_owner:n.Owner,set_requestToJoinLeaveEmailSetting:n.RequestToJoinLeaveEmailSetting})(u),u.update(),Lt(r,u,t)});case 3:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=9;break}return e.next=9,Promise.all(n.map(At));case 9:return this.report("create",t),e.abrupt("return",Et(i,t));case 11:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"update",value:(r=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var r=e.clientContext,n=e.element,i=o.getSPObject(n[Gn],r);return $t({set_allowMembersEditMembership:n.AllowMembersEditMembership,set_allowRequestToJoinLeave:n.AllowRequestToJoinLeave,set_autoAcceptRequestToJoinLeave:n.AutoAcceptRequestToJoinLeave,set_description:n.Description,set_onlyAllowMembersViewMembership:n.OnlyAllowMembersViewMembership,set_owner:n.Owner,set_requestToJoinLeaveEmailSetting:n.RequestToJoinLeaveEmailSetting,set_title:n[Gn]})(i),i.update(),Lt(r,i,t)});case 3:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=9;break}return e.next=9,Promise.all(n.map(At));case 9:return this.report("update",t),e.abrupt("return",Et(i,t));case 11:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"delete",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.iterator(function(e){var t=e.clientContext,r=e.element[Gn];return o.getSPObjectCollection(t)[Te(r)?"removeById":"removeByLoginName"](r),r});case 3:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=9;break}return e.next=9,Promise.all(n.map(At));case 9:return this.report("delete",t),e.abrupt("return",Et(i,t));case 11:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"user",value:function(e){return Wn(this,e)}},{key:"getSPObject",value:function(e,t){return this.getSPObjectCollection(t)[Te(e)?"getById":"getByName"](e)}},{key:"getSPObjectCollection",value:function(e){return this.parent.getSPObject(e).get_siteGroups()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};rt(e,c({},t,{name:this.name,box:this.box,contextUrl:"/"}))}},{key:"of",value:function(e){return xe(this.constructor)(this.parent,e)}}]),e}(),zn=xe(Jn),Xn="Label",Zn=function(e){return SP.Taxonomy.TaxonomySession.getTaxonomySession(e).getDefaultKeywordsTermStore()},ei=function(e){return Zn(e).get_keywordsTermSet()},ti=Re([he(Xn),pe(Xn)]),ri=H({object:function(e){var t=Object.assign({},e);return"/"!==e[Xn]&&(t[Xn]=pt(t[Xn])),t},string:function(e){return u({},Xn,"/"!==e&&e?e:void 0)},default:function(){return u({},Xn,void 0)}}),ni=function(e){function t(e){var r;return i(this,t),(r=g(this,f(t).call(this,e,ri,ti))).joinProp=Xn,r.prop=Xn,r}return l(t,Rt),t}(),ii=function(){function e(t,r){i(this,e),this.name="keyword",this.parent=t,this.keywords=r,this.box=xe(ni)(r),this.count=this.box.getCount(),this.iterator=St({elementBox:this.box})}var t,r,o,u;return a(e,[{key:"get",value:(u=n(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.isExact,n=void 0===r||r,e.next=4,this.iterator(function(e){var r=e.clientContext,i=e.element,o=SP.Taxonomy.TaxonomySession.getTaxonomySession(r).getDefaultKeywordsTermStore().get_keywordsTermSet().getTerms($t({set_defaultLabelOnly:i.DefaultLabelOnly||!1,set_resultCollectionSize:i.ResultCollectionSize||i.Limit||1e5,set_stringMatchOption:SP.Taxonomy.StringMatchOption[n?"exactMatch":"startsWith"],set_termLabel:i[Xn],set_trimDepricated:i.TrimDepricated||!0,set_trimUnavailable:i.TrimUnavailable||!0})(SP.Taxonomy.LabelMatchInformation.newObject(r)));return Lt(r,o,t)});case 4:return i=e.sent,o=i.clientContexts,a=i.result,e.next=9,Promise.all(o.map(At));case 9:return e.abrupt("return",Et(!this.box.isArray()&&n?a[0]:a,t));case 10:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"search",value:function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.get(c({},t,{isExact:!1})));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:(o=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element[Xn];if(n){var i=ei(r).createTerm(n,1033,we(SP.Guid.newGuid).toString());return Lt(r,i,t)}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("create",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"update",value:(r=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var r=e.clientContext,n=e.element,i=n[Xn];if(i){var a=o.getSPObject(i,r);return $t({set_isAvailableForTagging:n.IsAvailableForTagging,set_name:n.Name,set_owner:n.Owner})(a),Lt(r,a,t)}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("update",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"delete",value:(t=n(regeneratorRuntime.mark(function e(t){var r,n,i,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator(function(e){var t=e.clientContext,r=e.element[Xn];if(r){var n=Zn(t),i=o.getSPObject(r,t);return me("deleteObject")(i),me("commitAll")(n),r}});case 2:if(r=e.sent,n=r.clientContexts,i=r.result,!this.count){e.next=8;break}return e.next=8,Promise.all(n.map(At));case 8:return this.report("delete",t),e.abrupt("return",Et(i,t));case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tt(e,c({},t,{name:this.name,box:this.box}))}},{key:"getSPObject",value:function(e,t){return function(e){return ei(e).getAllTerms()}(t).getByName(e)}}]),e}(),oi=xe(ii),ai=/\S+@\S+\.\S+/,ui="To",si=H({object:A,default:function(){return u({},ui,"")}}),ci=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i(this,t),(e=g(this,f(t).call(this,r,si))).joinProp=ui,e.prop=ui,e}return l(t,Rt),a(t,[{key:"getCount",value:function(){return this.isArray()?this.value.length:1}}]),t}(),li=function(){function e(t,r){i(this,e),this.name="mail",this.parent=t,this.box=xe(ci)(r),this.count=this.box.getCount(),this.user=t.user.bind(t)}var t;return a(e,[{key:"send",value:(t=n(regeneratorRuntime.mark(function e(){var t,r,i,o,a=this,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.isFake,i=t.detailed,e.next=4,this.box.chain(function(){var e=n(regeneratorRuntime.mark(function e(n){var o,u,s,c,l,f,h,p,m,g,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.From,u=n.To,s=n.Subject,c=n.Body,(l=X(u)).length){e.next=4;break}throw new Error("Recievers are missed");case 4:if(s){e.next=6;break}throw new Error("Subject is missed");case 6:if(c){e.next=8;break}throw new Error("Body is missed");case 8:if(f=[],h=[],Z(function(e){return(ai.test(e)?f:h).push(e)})(l),p=f,m=o,o){e.next=18;break}return e.next=16,a.user().get({isSP:!0,view:"Email"});case 16:g=e.sent,m=g.Email;case 18:if(!r){e.next=20;break}return e.abrupt("return",void 0);case 20:return e.next=22,Mt("/",{url:"/_api/SP.Utilities.Utility.SendEmail",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},method:"POST",body:JSON.stringify({properties:{__metadata:{type:"SP.Utilities.EmailProperties"},From:m,To:{results:p},Subject:s,Body:c}})});case 22:return d=e.sent,i&&et("Mail is sent\nSender: ".concat(m,"\nRecievers: ").concat(p.join(", ")),t),e.abrupt("return",It(d,t));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:return o=e.sent,et("".concat(O.send," ").concat(this.count," ").concat(this.name).concat(this.count>1?"(s)":""),t),e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"of",value:function(e){return xe(this.constructor)(e)}}]),e}(),fi=xe(li),hi=xe(function(){function e(t){i(this,e),this.name="time",this.parent=t,this.contextUrl=this.parent.contextUrl||"/"}var t,r;return a(e,[{key:"get",value:(r=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){return new SP.RequestExecutor(t.contextUrl).executeAsync({url:"/_api/web/RegionalSettings/TimeZone",success:function(t){e(new Date(t.headers.DATE))},error:r})}));case 1:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)})},{key:"getZone",value:(t=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(this.contextUrl),n=this.parent.getSPObject(r).get_regionalSettings().get_timeZone(),e.next=4,Ft(r,n,t);case 4:return i=e.sent,e.abrupt("return",Et(i,t));case 6:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),e}()),pi=Re([st,lt]),mi=H({object:function(e){var t,r=Object.assign((u(t={},"Url",""),u(t,"Title",""),t),e);return!e.Url&&e.Title&&(r.Url=e.Title),"/"!==e.Url&&(r.Url=pt(r.Url)),!e.Title&&e.Url&&(r.Title=dt(e.Url)),r.Url=r.Url.replace("file:///",""),r},string:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return u(e={},"Url","/"===t?"/":pt(t.replace("file:///",""))),u(e,"Title",dt(t)),e},default:function(){var e;return u(e={},"Url",""),u(e,"Title",""),e}}),gi=function(){function t(r){i(this,t),this.name="web",this.box=xe(Rt)(r,mi,pi),this.id=e.MD5((new Date).getTime()).toString()}var r,o,u,s,l,f,h,p,m,g,d;return a(t,[{key:"get",value:(d=n(regeneratorRuntime.mark(function e(t){var r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.box.chain(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.Url,o=Tt(n),a=at(n)?i.getSPObjectCollection(o):i.getSPObject(o),e.abrupt("return",Ft(o,a,t));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return r=e.sent,e.abrupt("return",Et(r,t));case 4:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"create",value:(g=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.box.getIterable(),n=[],i=0;case 3:if(!(i<r.length)){e.next=22;break}return o=r[i],a=bt(o.Url),u=Tt(a),s=Re([we,$t({set_title:o.Title,set_description:o.Description,set_language:o.Language||1033,set_url:o.Title,set_useSamePermissionsAsParentSite:o.UseSamePermissionsAsParentSite||!0,set_webTemplate:o.WebTemplate}),de("add")(this.getSPObjectCollection(u)),N($t({set_alternateCssUrl:o.AlternateCssUrl,set_associatedMemberGroup:o.AssociatedMemberGroup,set_associatedOwnerGroup:o.AssociatedOwnerGroup,set_associatedVisitorGroup:o.AssociatedVisitorGroup,set_customMasterUrl:o.CustomMasterUrl,set_enableMinimalDownload:o.EnableMinimalDownload,set_masterUrl:o.MasterUrl,set_objectVersion:o.ObjectVersion,set_quickLaunchEnabled:o.QuickLaunchEnabled,set_saveSiteAsTemplateEnabled:o.SaveSiteAsTemplateEnabled,set_serverRelativeUrl:o.ServerRelativeUrl,set_siteLogoUrl:o.SiteLogoUrl,set_syndicationEnabled:o.SyndicationEnabled,set_treeViewEnabled:o.TreeViewEnabled,set_uiVersion:o.UiVersion,set_uiVersionConfigurationEnabled:o.UiVersionConfigurationEnabled})),N(me("update"))])(SP.WebCreationInformation),e.prev=8,e.t0=n,e.next=12,Ft(u,s,t);case 12:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=19;break;case 16:throw e.prev=16,e.t2=e.catch(8),e.t2;case 19:i+=1,e.next=3;break;case 22:return this.report("create",t),e.abrupt("return",Et(this.box.isArray()?n:n[0],t));case 24:case"end":return e.stop()}},e,this,[[8,16]])})),function(e){return g.apply(this,arguments)})},{key:"update",value:(m=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.box.getIterable(),n=[],i=0;case 3:if(!(i<r.length)){e.next=24;break}if(o=r[i],a=o.Url,wt(a)){e.next=8;break}return e.abrupt("return",void 0);case 8:return u=Tt(a),s=Re([$t({set_title:o.Title||void 0,set_description:o.Description,set_alternateCssUrl:o.AlternateCssUrl,set_associatedMemberGroup:o.AssociatedMemberGroup,set_associatedOwnerGroup:o.AssociatedOwnerGroup,set_associatedVisitorGroup:o.AssociatedVisitorGroup,set_customMasterUrl:o.CustomMasterUrl,set_enableMinimalDownload:o.EnableMinimalDownload,set_masterUrl:o.MasterUrl,set_objectVersion:o.ObjectVersion,set_quickLaunchEnabled:o.QuickLaunchEnabled,set_saveSiteAsTemplateEnabled:o.SaveSiteAsTemplateEnabled,set_serverRelativeUrl:o.ServerRelativeUrl,set_siteLogoUrl:o.SiteLogoUrl,set_syndicationEnabled:o.SyndicationEnabled,set_treeViewEnabled:o.TreeViewEnabled,set_uiVersion:o.UiVersion,set_uiVersionConfigurationEnabled:o.UiVersionConfigurationEnabled}),N(me("update"))])(this.getSPObject(u)),e.prev=10,e.t0=n,e.next=14,Ft(u,s,t);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=21;break;case 18:throw e.prev=18,e.t2=e.catch(10),e.t2;case 21:i+=1,e.next=3;break;case 24:return this.report("update",t),e.abrupt("return",Et(this.box.isArray()?n:n[0],t));case 26:case"end":return e.stop()}},e,this,[[10,18]])})),function(e){return m.apply(this,arguments)})},{key:"delete",value:(p=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.box.getIterable(),n=0;case 2:if(!(n<r.length)){e.next=21;break}if(i=r[n],o=i.Url,wt(o)){e.next=7;break}throw new Error("Wrong context url");case 7:return a=Tt(o),u=this.getSPObject(a),e.prev=9,u.deleteObject(),e.next=13,At(a);case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(9),e.t0;case 18:n+=1,e.next=2;break;case 21:return this.report("delete",t),e.abrupt("return",void 0);case 23:case"end":return e.stop()}},e,this,[[9,15]])})),function(e){return p.apply(this,arguments)})},{key:"doesUserHavePermissions",value:(h=n(regeneratorRuntime.mark(function e(){var t,r,i=this,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"fullMask",e.next=3,this.box.chain(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Tt(r.Url),o=we(SP.BasePermissions),void 0!==(a=Yt()[t])){e.next=5;break}throw new Error("Permission mask has invalid value");case 5:return o.set(a),u=i.getSPObject(n).doesUserHavePermissions(o),e.next=9,At(n);case 9:return e.abrupt("return",u.get_value());case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"getPermissions",value:(f=n(regeneratorRuntime.mark(function e(){var t,r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.box.chain(function(){var e=n(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(t.Url),e.abrupt("return",Ft(r,i.getSPObject(r),{view:"EffectiveBasePermissions"}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return t=e.sent,r=Yt(),e.abrupt("return",Object.keys(r).reduce(function(e,n){return e[n]=t.get_effectiveBasePermissions().has(r[n]),e},{}));case 5:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"breakRoleInheritance",value:(l=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.box.chain(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Tt(r.Url),i=t.getSPObject(n),me("breakRoleInheritance")(i),e.abrupt("return",At(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"resetRoleInheritance",value:(s=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.box.chain(function(){var e=n(regeneratorRuntime.mark(function e(r){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Tt(r.Url),i=t.getSPObject(n),me("resetRoleInheritance")(i),e.abrupt("return",At(n));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"getSite",value:(u=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt("/"),n=this.getSiteSPObject(r),e.next=4,Ft(r,n,t);case 4:return i=e.sent,e.abrupt("return",Et(i,t));case 6:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"getCustomListTemplates",value:(o=n(regeneratorRuntime.mark(function e(t){var r,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt("/"),n=this.getSiteSPObject(r),i=n.getCustomListTemplates(r.get_web()),e.next=5,Ft(r,i,t);case 5:return o=e.sent,e.abrupt("return",Et(o,t));case 7:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getWebTemplates",value:(r=n(regeneratorRuntime.mark(function e(t){var r,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt("/"),n=this.getSiteSPObject(r),i=n.getWebTemplates(1033,0),e.next=5,Ft(r,i,t);case 5:return o=e.sent,e.abrupt("return",Et(o,t));case 7:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"recycleBin",value:function(){return Ln(this)}},{key:"list",value:function(e){return xn(this,e,"list")}},{key:"library",value:function(e){return xn(this,e,"library")}},{key:"folder",value:function(e){return Tn(this,e)}},{key:"file",value:function(e){return jn(this,e)}},{key:"search",value:function(e){return zt(this,e)}},{key:"keyword",value:function(e){return oi(this,e)}},{key:"user",value:function(e){return Nn(this,e)}},{key:"userSP",value:function(e){return Nn(this,e,!0)}},{key:"group",value:function(e){return zn(this,e)}},{key:"mail",value:function(e){return fi(this,e)}},{key:"time",value:function(){return hi(this)}},{key:"getSPObject",value:function(e){return e.get_web()}},{key:"getSiteSPObject",value:function(e){return e.get_site()}},{key:"getSPObjectCollection",value:function(e){return this.getSPObject(e).get_webs()}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tt(e,c({},t,{name:this.name,box:this.box}))}},{key:"of",value:function(e){return xe(this.constructor)(e)}}]),t}();return xe(gi)}(CryptoJS,axios);
//# sourceMappingURL=index.min.js.map
